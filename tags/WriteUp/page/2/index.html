<!DOCTYPE html>
<html data-theme="">
<head>
    <!-- ! 引用文件位置-->
    <!--引用文件位置-->
<meta charset="utf-8">
<title>Hacked by Natro92.</title>
<!--    daisyui cdn-->
<link href="https://cdn.jsdelivr.net/npm/daisyui@4.5.0/dist/full.min.css" rel="stylesheet" type="text/css"/>
<!--     tailwindcss cdn daisyui 前置-->
<script src="https://cdn.tailwindcss.com"></script>
<!--    更改主题颜色-->
<script src="https://cdn.jsdelivr.net/npm/theme-change@2.0.2/index.js"></script>
<!--自动排版-->
<!--    <link rel="stylesheet" href="https://unpkg.com/@tailwindcss/typography@^0.4.0/dist/typography.min.css" type="text/css">-->
<script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
<!--    谷歌字体库镜像-->
<style>
    @import url('https://fonts.font.im/css?family=Barlow:700|Bitter');
</style>
<!--jquery-->
<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
<!--    fancybox-->
<link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" type="text/css">
<script src="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<!--highlight 代码高亮 使用hexo的不会高亮-->
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/highlight.min.js"></script>
<script>
    hljs.highlightAll();
</script>
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/styles/vs2015.min.css">
<!--LeanCLoud-->
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.2/dist/av.min.js"></script>
<!--卜算子busuanzi-->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!--    自定义css-->

<link rel="stylesheet" href="/css/output.css">


<link rel="stylesheet" href="/css/style.css">

<!--    自定义js-->

<script src="/js/view.js"></script>


<script src="/js/fancybox.js"></script>


<script src="/js/search.js"></script>

<!--去除referrer检测 要写在head里面 但是似乎影响进站查看-->
<meta name="referrer" content="no-referrer"/>
<link rel="shortcut icon" href="static/favicon.ico">
<meta name="generator" content="Hexo 7.0.0"></head>
<body>
<!--导航栏-->
<div class="fixed z-10 w-full">
    <div class="container-nav justify-center flex">
        <div class="navbar bg-base-100 shadow-xl rounded-box w-10/12 my-6 z-10">
            <div class="flex-1">
                <a class="btn btn-ghost text-xl" href="/">Natro92&#39;s Site</a>
            </div>
            <div class="flex-none gap-2">
                <ul class="menu menu-horizontal px-1">
                    
                    
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/">首页</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/blogs">归档</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/tags">标签</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/categories">分类</a></li>
                        
                            <!--去掉最后一位是，-->
                            <li><a href="/link">更多</a></li>
                        
                    
                    <!--<li><a href="/">Home</a></li>-->
                    <!--<li><a href="/blogs">Archive</a></li>-->
                    <!--<li><a href="/about/">About</a></li>-->
                    <li>
                        <details class="dropdown">
                            <summary>
                                更换主题
                            </summary>
                            <ul tabindex="0"
                                class="dropdown-content z-[1] p-2 bg-base-100 rounded-box w-58 max-h-96 overflow-y-auto overflow-x-hidden shadow">
                                <!--                                <li><a class="border-base-content/20 hover:border-base-content/40 overflow-hidden rounded-lg border outline outline-2 outline-offset-2 outline-transparent !outline-base-content" data-set-theme="emerald" data-act-class="!outline-base-content"><div data-theme="emerald" class="bg-base-100 text-base-content w-full cursor-pointer font-sans"><div class="grid grid-cols-5 grid-rows-3"><div class="bg-base-200 col-start-1 row-span-2 row-start-1"></div> <div class="bg-base-300 col-start-1 row-start-3"></div> <div class="bg-base-100 col-span-4 col-start-2 row-span-3 row-start-1 flex flex-col gap-1 p-2"><div class="font-bold">emerald</div> <div class="flex flex-wrap gap-1"><div class="bg-primary flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-primary-content text-sm font-bold">A</div></div> <div class="bg-secondary flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-secondary-content text-sm font-bold">A</div></div> <div class="bg-accent flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-accent-content text-sm font-bold">A</div></div> <div class="bg-neutral flex aspect-square w-5 items-center justify-center rounded lg:w-6"><div class="text-neutral-content text-sm font-bold">A</div></div></div></div></div></div> </a></li>-->
                                <!--主题选择配置，主题来自daisyui-->

<li><a data-set-theme="light">Light</a></li>
<li><a data-set-theme="dark">Night</a></li>
<li><a data-set-theme="cupcake">Cupcake</a></li>
<li><a data-set-theme="bumblebee">Bumblebee</a></li>
<li><a data-set-theme="emerald">Emerald</a></li>
<li><a data-set-theme="coporate">Corporate</a></li>
<li><a data-set-theme="synthwave">Synthwave</a></li>
<li><a data-set-theme="retro">Retro</a></li>
<li><a data-set-theme="cyberpunk">Cyberpunk</a></li>
<li><a data-set-theme="halloween">Halloween</a></li>
<li><a data-set-theme="garden">Garden</a></li>
<li><a data-set-theme="forest">Forest</a></li>
<li><a data-set-theme="aqua">Aqua</a></li>
<li><a data-set-theme="lofi">Lo-fi</a></li>
<li><a data-set-theme="pastel">Pastel</a></li>
<li><a data-set-theme="fantasy">Fantasy</a></li>
<li><a data-set-theme="wireframe">Wireframe</a></li>
<li><a data-set-theme="black">Black</a></li>
<li><a data-set-theme="luxury">Luxury</a></li>
<li><a data-set-theme="dracula">Dracula</a></li>
<li><a data-set-theme="cmyk">CMYK</a></li>
<li><a data-set-theme="autumn">Autumn</a></li>
<li><a data-set-theme="business">Business</a></li>
<li><a data-set-theme="acid">Acid</a></li>
<li><a data-set-theme="lemonade">Lemonade</a></li>
<li><a data-set-theme="night">Night</a></li>
<li><a data-set-theme="coffee">Coffee</a></li>
<li><a data-set-theme="winter">Winter</a></li>
<li><a data-set-theme="dim">Dim</a></li>
<li><a data-set-theme="nord">Nord</a></li>
<li><a data-set-theme="sunset">Sunset</a></li>
                            </ul>
                        </details>
                    </li>
                </ul>
                <div class="form-control">

                    <input type="text" placeholder="Search it!" id="local-search-input"
                           class="st-search-input input input-bordered w-24 md:w-auto rounded-xl"/>
                    <div id="local-search-result" class="local-search-result-cls rounded-xl"></div>
                    <script type="text/javascript" id="local.search.active">
                        var inputArea = document.querySelector("#local-search-input");
                        inputArea.onclick = function () {
                            getSearchFile();
                            this.onclick = null
                        }
                        inputArea.onkeydown = function () {
                            if (event.keyCode === 13) return false
                        }
                    </script>
                </div>
                <div class="dropdown dropdown-end">
                    <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
                        <div class="w-10 rounded-full">
                            <a target="_blank" rel="noopener" href="https://github.com/natro92">
                                <img alt="Tailwind CSS Navbar component"
                                     src="https://cdn.nlark.com/yuque/0/2024/png/34866087/1706006117478-a75e82ba-dea0-46bd-be3b-fa82cb80209c.png"/>
                            </a>
                        </div>
                    </div>
                    <!--TODO 完成这里-->
                    <!--<ul tabindex="0"-->
                    <!--    class="mt-3 z-[1] p-2 shadow menu menu-sm dropdown-content bg-base-100 rounded-box w-52">-->
                    <!--    <li>-->
                    <!--        <a class="justify-between">-->
                    <!--            Profile-->
                    <!--            <span class="badge">New</span>-->
                    <!--        </a>-->
                    <!--    </li>-->
                    <!--    <li><a>Settings</a></li>-->
                    <!--    <li><a>Logout</a></li>-->
                    <!--</ul>-->
                </div>
            </div>
        </div>
    </div>
</div>
<!--导航栏结束-->
<div class="h-36 w-full"></div>
<div class="fleet">
    <!--    嵌套位置-->
    <!--居中显示-->
<div class="justify-center flex my-12">
    <h2 class="text-3xl font-bold mt-4 mb-2">- WriteUp -</h2>
</div>
<!-- 主页 -->
<!--宣传页面-->
<!--视图容器-->
<!--判断如果在首页则显示开页图-->

<!--使模块纵排列-->
<div class="w-full container-nav justify-center flex index-cards">
    <ul class="w-8/12">
        <!--        单块开始-->
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/84a9ce9a/" id="hover-text">web191-web213SQL注入篇（二）</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/07/12 23:27</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web191
跟上题一样，由于换了一章，就重新叙述一下。
布尔盲注需要先找到一个可改变的注入点。
比如：

 * admin&#39; and 0#时返回的是用户名不存在
 * admin&#39; and 1#返回的是密码错误

由此编写脚本：这题还是用是190的脚本即可
直接使用paayload：

# -*- encoding: utf-8 -*-
&#34;&#34;&#34;
@File    :   SQL布尔盲注2.py   
@Contact :   2997453446@qq.com
@Blog    :   natro92.github.io
 
@Modify Time      @Author    @Ver</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/84a9ce9a/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/65bd4621/" id="hover-text">web171-web190SQL注入篇</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/07/11 23:27</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web171

$sql = &#34;select username,password from user where username !=&#39;flag&#39; and id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39; limit 1;&#34;;

三栏一眼丁真，直接内容拼入即可。

-1&#39; union select 1,2,database() --+

查询库名：

-1&#39; union select 1,2,group_concat(schema_name) from information_schema.schemata --+

information_schema,test,mysql,performan</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/65bd4621/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/94aa1d46/" id="hover-text">web151-web170文件上传篇</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/07/09 19:37</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web151、web152
前端校验
根据提示，检验写在了前端。

layui.use(&#39;upload&#39;, function(){
  var upload = layui.upload;
   
  //执行实例
  var uploadInst = upload.render({
    elem: &#39;#upload&#39; //绑定元素
    ,url: &#39;/upload/&#39; //上传接口
    ,done: function(res){
    	if(res.code==0){
    		$(&#34;#result&#34;).html(&#34;文件上传成功，路径：&#34;+res.msg);
    	}e</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/94aa1d46/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/8b1fb998/" id="hover-text">web106-web131php特性篇（二）</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/07/09 19:35</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web106
highlight_file(__FILE__);
include(&#34;flag.php&#34;);

if(isset($_POST[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;])){
  $v1 = $_POST[&#39;v1&#39;];
  $v2 = $_GET[&#39;v2&#39;];
  if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2){
    echo $flag;
  }
}

数组和转为0e都行，这里图省事使用了数组绕过。


web107 parse_str
highlight_file(__FILE__);
error_reporting(0);
inc</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/8b1fb998/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/12c981c1/" id="hover-text">CISCN2023 wp</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/05/29 22:04</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CISCN/" class="text-xs font-mono" id="hover-text">CISCN</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>战队答题情况
排名：282


解题列表
Web
 * BackendService

Pwn
 * 烧烤摊儿 
 * funcanary

Misc
 * 签到卡 
 * pyshell 
 * 网络安全人才实战能力评价现状调查问卷

Re
 * babyRE 
 * ezAndroid

Crypto
 * 基于国密SM2算法的密钥密文分发 
 * Sign_in_passwd




Web
BackendService
在nacos权限绕过漏洞，网上找了一个payload
nacos抓包，修改返回包中参数，登录

https://xz.aliyun.com/t/11493#toc-5
</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/12c981c1/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/37f43c4f/" id="hover-text">web89-web105php特性篇（一）</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/05/16 19:42</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web89
include(&#34;flag.php&#34;);
highlight_file(__FILE__);

if(isset($_GET[&#39;num&#39;])){
    $num = $_GET[&#39;num&#39;];
    if(preg_match(&#34;/[0-9]/&#34;, $num)){
        die(&#34;no no no!&#34;);
    }
    if(intval($num)){
        echo $flag;
    }
}

遇事不决先试试数组捏，?num[]=1

web90
include(&#34;flag.php&#34;);
highlight_file(__FILE__);
if</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/37f43c4f/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/e63f4b1d/" id="hover-text">web118-web122+web124命令执行篇（四）</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/04/13 22:32</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>参考链接：

https://blog.csdn.net/weixin_46081055/article/details/121721209

web118
题目里面提示了：flag in flag.php
随便提交一点东西，看到源代码中：

post上传然后system执行，但是没有回显。
但是输入会出现evil input，因此想到可能是有过滤。
fuzz一下：
发现有的字符被过滤掉了：

剩余的字符有A-Z，;:{}?#$_,@~
看了wp学了一个新姿势：以下是在本地测试的。


我们到web测试一下：
web上的用户名末尾为l，path末尾为n，因此我们可以尝试组合：

${PATH:</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/e63f4b1d/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/a20f5212/" id="hover-text">web58-77命令执行篇（三）</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/04/13 22:30</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web58
if(isset($_POST[&#39;c&#39;])){
  $c= $_POST[&#39;c&#39;];
  eval($c);
}else{
  highlight_file(__FILE__);
}

正常来说，看到这个格式，我们第一个想到的就是使用system然后命令执行，但是当我们尝试使用时会发现：

这是因为php.ini配置中默认禁用了执行系统外部命令函数，但是这里我们可以用php内置函数来读取文件，因此这部分学习的时php相关函数的使用。
我们需要先查看当前目录。c=print_r(glob(&#34;*&#34;));

或者c=print_r(scandir(&#39;.&#39;));（注意两者的返回数组内容不同</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/a20f5212/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/979871d9/" id="hover-text">web42-57命令执行篇（二）</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/03/30 17:13</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web42
if(isset($_GET[&#39;c&#39;])){
  $c=$_GET[&#39;c&#39;];
  system($c.&#34; &gt;/dev/null 2&gt;&amp;1&#34;);
}else{
  highlight_file(__FILE__);
}

在变量后面拼接了一堆字符串。在此之前，我们需要先思考这一串是什么东西。

&gt;/dev/null 2&gt;&amp;1 

就是让标准输出重定向到/dev/null中（丢弃标准输出），然后错误输出由于重用了标准输出的描述符，所以错误输出也被定向到了/dev/null中，错误输出同样也被丢弃了。执行了这条命令之后，该条shell命令将不会输出任何信息到控制台，也不会有任何信息输出</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/979871d9/'">See More.</button>
                    </div>
                </div>
            </div>
        
<!--            可以通过添加 btn-ghost 来让card变深色-->
            <div class="card w-full bg-base-100 shadow-xl my-4" id="index-post-show">
                <div class="card-body">
                    <!--标题-->
                    <h2 class="card-title"><a href="/posts/b5586866/" id="hover-text">web29-41命令执行篇（一）</a></h2>
                    <div class="flex flex-row gap-4">
                        <!--时间-->
                        <div class="text-xs font-mono">2023/03/15 22:12</div>
                        <div class="text-xs font-mono">|</div>
                        <!-- ! 无法做到在不收到外部a的影响可以点击跳转的标签-->
                        <!--标签-->
                        <div class="flex flex-row gap-3">
                            <a href="/tags/WriteUp/" class="text-xs font-mono" id="hover-text">WriteUp</a> <a href="/tags/CTFshow0-1/" class="text-xs font-mono" id="hover-text">CTFshow0-1</a>
                        </div>
                        <div class="text-xs font-mono">|</div>
                        <!--分类-->
                        <div class="flex flex-row gap-3">
                            <a href="/categories/CTF/" class="text-xs font-mono" id="hover-text">CTF</a>
                        </div>

                    </div>

                    <!--摘要开始-->
                    
                        <p>web29
error_reporting(0);
if(isset($_GET[&#39;c&#39;])){
    $c = $_GET[&#39;c&#39;];
    if(!preg_match(&#34;/flag/i&#34;, $c)){
        eval($c);
    }
    
}else{
    highlight_file(__FILE__);
}

很简单的一道题。?c=system(&#34;ls&#34;);查看一下发现flag.php就在当前目录下，因为过滤了flag字节，所以直接用f*代替就行
payload：?c=system(&#34;cat f*&#34;);
flag在源代码中。

其他解法
 * 除此之外，我</p> <!-- 如果excerpt字段不为空，则显示excerpt -->
                    
                    <!--摘要结束-->
                    <div class="card-actions justify-end">
                        <button class="btn btn-primary" onclick="window.location.href='/posts/b5586866/'">See More.</button>
                    </div>
                </div>
            </div>
        
        <!--        单块结束-->
    </ul>
</div>

<!--分页器-->
<div class="w-full container-nav justify-center flex mt-16">
    <div class="join">
        <a class="extend prev" rel="prev" href="/tags/WriteUp/"><button class="join-item btn">&laquo;</button></a><a class="join-item btn" href="/tags/WriteUp/">1</a><span class="join-item btn btn-disabled">2</span><a class="join-item btn" href="/tags/WriteUp/page/3/">3</a><a class="extend next" rel="next" href="/tags/WriteUp/page/3/"><button class="join-item btn">&raquo;</button></a>
    </div>
</div>
<!--添加一个空格高度-->
<div class="h-24"></div>



    <!--    嵌套位置结束-->
    <!--<h3>categories</h3>-->
    <!--<ul>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/CTF/">-->
    <!--                CTF-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/CTF/JavaSec/">-->
    <!--                JavaSec-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/Python/">-->
    <!--                Python-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/categories/Lupas/">-->
    <!--                Lupas-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--</ul>-->

    <!--<h3>tags</h3>-->
    <!--<ul>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">-->
    <!--                Java反序列化-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CC%E9%93%BE/">-->
    <!--                CC链-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/WriteUp/">-->
    <!--                WriteUp-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CISCN/">-->
    <!--                CISCN-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/CTFshow0-1/">-->
    <!--                CTFshow0-1-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/%E8%84%9A%E6%9C%AC/">-->
    <!--                脚本-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Tampermonkey/">-->
    <!--                Tampermonkey-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Shortcut/">-->
    <!--                Shortcut-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/%E8%AF%AD%E9%9B%80/">-->
    <!--                语雀-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Hexo/">-->
    <!--                Hexo-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Lupas/">-->
    <!--                Lupas-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--        <li>-->
    <!--            <a href="/tags/Hexo%E4%B8%BB%E9%A2%98/">-->
    <!--                Hexo主题-->
    <!--            </a>-->
    <!--        </li>-->
    <!--    -->
    <!--</ul>-->
</div>
<!--返回顶部按钮-->
<button class="backToTopBtn btn" title="返回顶部">&#8593;</button>
<!--加个渐变，但还是有点丑-->
<!-- TODO 换个更好的方案-->
<div class="h-1 bg-gradient-to-t from-base-content to-base-100">
</div>

<footer class="footer p-10 bg-neutral text-neutral-content">
    <aside>
        <svg width="50" height="50" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" class="fill-current mt-3"><path d="M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z"></path></svg>
        © 2020-2024 Lupas by Natro92
        <pre class="whitespace-pre-line">框架 <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">Hexo</a> | 主题 <a target="_blank" rel="noopener" href="https://www.example.com">Lupas</a></pre>
    </aside>
    <nav>
        <header class="footer-title">Social</header>
        <!--<div class="grid grid-flow-col gap-4">-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a>-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></a>-->
        <!--    <a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"></path></svg></a>-->
        <!--</div>-->
    </nav>
</footer>
</body>

</html>


